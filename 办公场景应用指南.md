# AI PowerShell 智能助手 - 办公场景应用指南

## 📖 简介

这份指南展示如何用**中文自然语言**完成各种办公任务，无需记忆复杂的 PowerShell 命令！

**使用方法：**
```bash
# 启动程序
python -m src.main

# 然后直接用中文描述你想做什么
💬 请输入 > 显示CPU使用率最高的5个进程
```

---

## 📁 文件管理自动化

### 1. 批量重命名文件

**场景：** 需要将文件夹中的所有文件统一命名格式

**中文输入示例：**
```
查看当前文件夹的所有文件
```

**生成命令：**
```powershell
Get-ChildItem
```

**进阶操作（需要手动执行）：**
```
# 批量重命名为 "合同_2025_序号.pdf"
Get-ChildItem *.pdf | ForEach-Object -Begin {$count=1} -Process {
    Rename-Item $_ -NewName "合同_2025_$($count.ToString('000')).pdf"
    $count++
}
```

---

### 2. 文件分类整理

**场景：** 按文件类型自动分类到不同文件夹

**中文输入示例：**
```
显示当前文件夹中所有文件的扩展名统计
```

**生成命令：**
```powershell
Get-ChildItem -File | Group-Object Extension | Select-Object Name, Count
```

**输出示例：**
```
Name    Count
----    -----
.pdf      45
.docx     32
.xlsx     28
.jpg      156
.png      89
```

---

### 3. 查找重复文件

**场景：** 找出重复的文件以节省空间

**中文输入示例：**
```
查找当前文件夹中大小相同的文件
```

**生成命令：**
```powershell
Get-ChildItem -Recurse -File | Group-Object Length | Where-Object {$_.Count -gt 1} | Select-Object Name, Count
```

---

### 4. 大文件查找

**场景：** 找出占用空间大的文件

**中文输入示例：**
```
显示当前文件夹中大于100MB的文件
```

**生成命令：**
```powershell
Get-ChildItem -Recurse -File | Where-Object {$_.Length -gt 100MB} | Sort-Object Length -Descending | Select-Object Name, @{Name="Size(MB)";Expression={[math]::Round($_.Length/1MB,2)}}
```

---

## 📊 数据处理和报表

### 5. 文件统计报告

**场景：** 生成文件夹的统计报告

**中文输入示例：**
```
统计当前文件夹的文件数量和总大小
```

**生成命令：**
```powershell
Get-ChildItem -Recurse -File | Measure-Object -Property Length -Sum | Select-Object Count, @{Name="TotalSize(GB)";Expression={[math]::Round($_.Sum/1GB,2)}}
```

**输出示例：**
```
Count TotalSize(GB)
----- -------------
  450          12.34
```

---

### 6. 按日期统计文件

**场景：** 查看最近修改的文件

**中文输入示例：**
```
显示最近7天修改过的文件
```

**生成命令：**
```powershell
Get-ChildItem -Recurse -File | Where-Object {$_.LastWriteTime -gt (Get-Date).AddDays(-7)} | Select-Object Name, LastWriteTime
```

---

### 7. 文件类型分布统计

**场景：** 了解文件夹中各类文件的占比

**中文输入示例：**
```
按文件类型统计文件数量和总大小
```

**生成命令：**
```powershell
Get-ChildItem -Recurse -File | Group-Object Extension | Select-Object Name, Count, @{Name="TotalSize(MB)";Expression={[math]::Round(($_.Group | Measure-Object Length -Sum).Sum/1MB,2)}} | Sort-Object TotalSize -Descending
```

---

## 🔍 信息收集和监控

### 8. 系统性能监控

**场景：** 检查电脑运行状态

**中文输入示例：**
```
显示CPU使用率最高的10个进程
```

**生成命令：**
```powershell
Get-Process | Sort-Object CPU -Descending | Select-Object -First 10 Name, CPU, @{Name="Memory(MB)";Expression={[math]::Round($_.WorkingSet/1MB,2)}}
```

---

### 9. 内存使用监控

**中文输入示例：**
```
显示内存使用最多的10个进程
```

**生成命令：**
```powershell
Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 Name, @{Name="Memory(MB)";Expression={[math]::Round($_.WorkingSet/1MB,2)}}
```

---

### 10. 磁盘空间检查

**中文输入示例：**
```
显示所有磁盘的使用情况
```

**生成命令：**
```powershell
Get-PSDrive -PSProvider FileSystem | Select-Object Name, @{Name="Used(GB)";Expression={[math]::Round($_.Used/1GB,2)}}, @{Name="Free(GB)";Expression={[math]::Round($_.Free/1GB,2)}}
```

---

### 11. 网络连接监控

**中文输入示例：**
```
显示所有建立的网络连接
```

**生成命令：**
```powershell
Get-NetTCPConnection -State Established | Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State
```

---

## 📅 时间和任务管理

### 12. 系统运行时间

**中文输入示例：**
```
显示系统启动时间和运行时长
```

**生成命令：**
```powershell
Get-CimInstance Win32_OperatingSystem | Select-Object @{Name="LastBootTime";Expression={$_.LastBootUpTime}}, @{Name="Uptime";Expression={(Get-Date) - $_.LastBootUpTime}}
```

---

### 13. 文件修改时间统计

**场景：** 追踪项目进度

**中文输入示例：**
```
显示今天修改过的所有文件
```

**生成命令：**
```powershell
Get-ChildItem -Recurse -File | Where-Object {$_.LastWriteTime.Date -eq (Get-Date).Date} | Select-Object Name, LastWriteTime
```

---

## 🛠️ 系统维护

### 14. 临时文件查找

**中文输入示例：**
```
显示临时文件夹的大小
```

**生成命令：**
```powershell
Get-ChildItem $env:TEMP -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum | Select-Object Count, @{Name="TotalSize(MB)";Expression={[math]::Round($_.Sum/1MB,2)}}
```

---

### 15. 系统服务检查

**中文输入示例：**
```
显示所有正在运行的服务
```

**生成命令：**
```powershell
Get-Service | Where-Object {$_.Status -eq 'Running'} | Select-Object Name, DisplayName, Status
```

---

### 16. 启动程序检查

**中文输入示例：**
```
显示开机自动启动的程序
```

**生成命令：**
```powershell
Get-CimInstance Win32_StartupCommand | Select-Object Name, Command, Location
```

---

## 📋 文档和内容处理

### 17. 文件内容搜索

**中文输入示例：**
```
在当前文件夹的所有txt文件中搜索包含"合同"的内容
```

**生成命令：**
```powershell
Get-ChildItem -Filter *.txt -Recurse | Select-String -Pattern "合同" | Select-Object Path, LineNumber, Line
```

---

### 18. 文件夹结构导出

**场景：** 生成文件夹目录树

**中文输入示例：**
```
显示当前文件夹的目录结构
```

**生成命令：**
```powershell
Get-ChildItem -Recurse | Select-Object FullName, @{Name="Type";Expression={if($_.PSIsContainer){"Folder"}else{"File"}}}
```

---

## 🔐 安全和合规

### 19. 文件权限检查

**中文输入示例：**
```
显示当前文件夹的访问权限
```

**生成命令：**
```powershell
Get-Acl . | Select-Object Path, Owner, AccessToString
```

---

### 20. 最近访问的文件

**中文输入示例：**
```
显示最近访问的10个文件
```

**生成命令：**
```powershell
Get-ChildItem -Recurse -File | Sort-Object LastAccessTime -Descending | Select-Object -First 10 Name, LastAccessTime
```

---


## 📈 效率提升工具

### 21. 快速查看系统信息

**中文输入示例：**
```
显示计算机的基本信息
```

**生成命令：**
```powershell
Get-ComputerInfo | Select-Object CsName, OsName, OsVersion, CsProcessors, OsTotalVisibleMemorySize
```

---

### 22. 环境变量查看

**中文输入示例：**
```
显示所有环境变量
```

**生成命令：**
```powershell
Get-ChildItem Env: | Select-Object Name, Value
```

---

### 23. 已安装软件列表

**中文输入示例：**
```
显示所有已安装的软件
```

**生成命令：**
```powershell
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate
```

---

## 🎯 实用组合场景

### 场景A：每日工作开始前的系统检查

**操作流程：**

1️⃣ **检查系统状态**
```
显示当前时间
```

2️⃣ **检查磁盘空间**
```
显示所有磁盘的使用情况
```

3️⃣ **检查运行的程序**
```
显示CPU使用率最高的5个进程
```

4️⃣ **检查网络连接**
```
测试到www.baidu.com的网络连接
```

**预计耗时：** 2分钟  
**效果：** 快速了解电脑状态，发现潜在问题

---

### 场景B：项目文件整理

**操作流程：**

1️⃣ **查看文件分布**
```
按文件类型统计文件数量
```

2️⃣ **找出大文件**
```
显示大于50MB的文件
```

3️⃣ **查看最近修改**
```
显示最近3天修改过的文件
```

4️⃣ **生成统计报告**
```
统计当前文件夹的文件数量和总大小
```

**预计耗时：** 3分钟  
**效果：** 了解项目文件状况，便于整理和归档

---

### 场景C：性能问题排查

**操作流程：**

1️⃣ **检查CPU使用**
```
显示CPU使用率最高的10个进程
```

2️⃣ **检查内存使用**
```
显示内存使用最多的10个进程
```

3️⃣ **检查磁盘IO**
```
显示所有磁盘的使用情况
```

4️⃣ **检查网络连接**
```
显示所有建立的网络连接
```

5️⃣ **查看系统运行时间**
```
显示系统启动时间
```

**预计耗时：** 5分钟  
**效果：** 全面了解系统性能，定位问题根源

---

### 场景D：文件清理和优化

**操作流程：**

1️⃣ **查找重复文件**
```
查找当前文件夹中大小相同的文件
```

2️⃣ **查找大文件**
```
显示大于100MB的文件
```

3️⃣ **检查临时文件**
```
显示临时文件夹的大小
```

4️⃣ **统计文件类型**
```
按文件类型统计文件数量和总大小
```

**预计耗时：** 5-10分钟  
**效果：** 找出可以清理的文件，释放磁盘空间

---

## 💡 使用技巧

### 技巧1：使用清晰的描述

✅ **好的描述：**
- "显示CPU使用率最高的10个进程"
- "查找大于100MB的文件"
- "显示最近7天修改过的文件"

❌ **不好的描述：**
- "看看CPU"（太模糊）
- "找文件"（不够具体）
- "最近的"（时间范围不明确）

---

### 技巧2：善用历史命令

```
# 查看历史
💬 请输入 > history

# 可以看到之前执行过的所有命令
# 学习生成的PowerShell命令
# 下次可以直接用类似的描述
```

---

### 技巧3：组合使用

先用简单命令探索，再用复杂命令深入：

```
1. 显示当前文件夹的所有文件
   ↓ 发现有很多PDF文件
   
2. 显示所有PDF文件的大小
   ↓ 发现有些很大
   
3. 显示大于10MB的PDF文件
   ↓ 找到需要清理的文件
```

---

### 技巧4：保存常用命令

对于经常使用的操作，可以：

1. 查看生成的PowerShell命令
2. 保存到文本文件
3. 需要时直接复制使用

---

## 📊 效率对比

### 传统方式 vs AI助手

| 任务 | 传统方式 | AI助手 | 效率提升 |
|------|---------|--------|---------|
| 查找大文件 | 手动浏览，5-10分钟 | 中文描述，30秒 | **10-20倍** |
| 统计文件 | Excel手动统计，10分钟 | 一条命令，10秒 | **60倍** |
| 性能监控 | 打开任务管理器，手动记录 | 自动生成报告 | **5-10倍** |
| 文件搜索 | Windows搜索，慢且不准 | 精确搜索，快速 | **5倍** |
| 批量操作 | 手动一个个处理 | 一次性完成 | **100倍+** |

---

## 🎓 学习路径

### 新手（第1周）

**目标：** 熟悉基本操作

**练习任务：**
1. 查看当前时间
2. 显示文件列表
3. 查看磁盘空间
4. 显示进程列表
5. 查看系统信息

**预期效果：** 能用中文完成基本的系统查询

---

### 进阶（第2-3周）

**目标：** 掌握文件管理

**练习任务：**
1. 统计文件数量和大小
2. 查找特定类型的文件
3. 按日期筛选文件
4. 查找大文件
5. 文件内容搜索

**预期效果：** 能高效管理和整理文件

---

### 高级（第4周+）

**目标：** 解决实际问题

**练习任务：**
1. 性能问题排查
2. 批量文件处理
3. 自动化日常任务
4. 生成统计报告
5. 系统维护优化

**预期效果：** 能独立解决复杂的办公问题

---

## 🚀 快速开始

### 1. 启动程序

```bash
python -m src.main
```

### 2. 尝试第一个命令

```
💬 请输入 > 显示当前时间
```

### 3. 查看结果

```
✅ 执行成功

📄 输出:
2025年10月7日 10:30:45
```

### 4. 继续探索

```
💬 请输入 > 显示CPU使用率最高的5个进程
```

---

## 📞 获取帮助

### 程序内帮助

```
💬 请输入 > help
```

### 查看历史

```
💬 请输入 > history
```

### 清空屏幕

```
💬 请输入 > clear
```

### 退出程序

```
💬 请输入 > exit
```

---

## 🎉 总结

通过 AI PowerShell 智能助手，你可以：

✅ **用中文完成专业操作** - 无需学习PowerShell语法  
✅ **提高工作效率** - 自动化重复性任务  
✅ **减少出错** - 安全检查和确认机制  
✅ **快速学习** - 查看生成的命令学习PowerShell  
✅ **解决实际问题** - 系统监控、文件管理、数据处理

**开始使用，让工作更轻松！** 🚀

---

## 📚 相关文档

- [新手指南-程序流程图.md](新手指南-程序流程图.md) - 了解程序工作原理
- [复杂场景模拟.md](复杂场景模拟.md) - 查看实际使用案例
- [OLLAMA_SETUP.md](OLLAMA_SETUP.md) - AI模型配置说明
- [README.md](README.md) - 项目总体介绍

---

**提示：** 这份指南会持续更新，添加更多实用场景和技巧！
