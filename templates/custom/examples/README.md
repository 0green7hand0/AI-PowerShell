# è‡ªå®šä¹‰æ¨¡æ¿ç¤ºä¾‹

æœ¬ç›®å½•åŒ…å«ä¸‰ä¸ªç¤ºä¾‹è‡ªå®šä¹‰æ¨¡æ¿ï¼Œå±•ç¤ºå¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨è‡ªå®šä¹‰ PowerShell è„šæœ¬æ¨¡æ¿ã€‚

## ğŸ“‹ ç¤ºä¾‹æ¨¡æ¿åˆ—è¡¨

### 1. simple_backup.ps1 - ç®€å•æ–‡ä»¶å¤‡ä»½å·¥å…·

**åŠŸèƒ½**: å°†æŒ‡å®šç›®å½•çš„æ–‡ä»¶å¤‡ä»½åˆ°ç›®æ ‡ä½ç½®ï¼Œæ”¯æŒå¢é‡å¤‡ä»½å’Œå‹ç¼©

**å‚æ•°**:
- `SOURCE_PATH` (path, å¿…éœ€): æºæ–‡ä»¶å¤¹è·¯å¾„
- `DEST_PATH` (path, å¿…éœ€): å¤‡ä»½ç›®æ ‡è·¯å¾„
- `COMPRESS` (boolean, å¯é€‰): æ˜¯å¦å‹ç¼©å¤‡ä»½ï¼Œé»˜è®¤ false
- `INCREMENTAL` (boolean, å¯é€‰): æ˜¯å¦å¢é‡å¤‡ä»½ï¼Œé»˜è®¤ false

**ä½¿ç”¨åœºæ™¯**:
- å®šæœŸå¤‡ä»½é‡è¦æ–‡ä»¶
- é¡¹ç›®æ–‡ä»¶å¤‡ä»½
- æ–‡æ¡£è‡ªåŠ¨å¤‡ä»½

**ç¤ºä¾‹è¯·æ±‚**:
```
å¸®æˆ‘åˆ›å»ºä¸€ä¸ªå¤‡ä»½è„šæœ¬ï¼Œå¤‡ä»½æˆ‘çš„æ–‡æ¡£åˆ°Dç›˜
ç”Ÿæˆä¸€ä¸ªå‹ç¼©å¤‡ä»½è„šæœ¬
```

---

### 2. log_analyzer.ps1 - æ—¥å¿—æ–‡ä»¶åˆ†æå·¥å…·

**åŠŸèƒ½**: åˆ†ææ—¥å¿—æ–‡ä»¶ï¼Œç»Ÿè®¡é”™è¯¯ã€è­¦å‘Šä¿¡æ¯ï¼Œç”Ÿæˆåˆ†ææŠ¥å‘Š

**å‚æ•°**:
- `LOG_PATH` (path, å¿…éœ€): æ—¥å¿—æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„
- `ERROR_PATTERN` (string, å¯é€‰): é”™è¯¯åŒ¹é…æ¨¡å¼ï¼Œé»˜è®¤ "error|exception|fail"
- `WARNING_PATTERN` (string, å¯é€‰): è­¦å‘ŠåŒ¹é…æ¨¡å¼ï¼Œé»˜è®¤ "warning|warn"
- `OUTPUT_REPORT` (boolean, å¯é€‰): æ˜¯å¦ç”ŸæˆæŠ¥å‘Šæ–‡ä»¶ï¼Œé»˜è®¤ true
- `REPORT_PATH` (path, å¯é€‰): æŠ¥å‘Šä¿å­˜è·¯å¾„

**ä½¿ç”¨åœºæ™¯**:
- åº”ç”¨ç¨‹åºæ—¥å¿—åˆ†æ
- ç³»ç»Ÿæ—¥å¿—ç›‘æ§
- é”™è¯¯æ’æŸ¥

**ç¤ºä¾‹è¯·æ±‚**:
```
åˆ†æç³»ç»Ÿæ—¥å¿—ï¼Œæ‰¾å‡ºæ‰€æœ‰é”™è¯¯å’Œè­¦å‘Š
å¸®æˆ‘åˆ†æåº”ç”¨æ—¥å¿—æ–‡ä»¶
```

---

### 3. user_report.ps1 - ç”¨æˆ·æ´»åŠ¨æŠ¥å‘Šç”Ÿæˆå™¨

**åŠŸèƒ½**: ç”Ÿæˆç³»ç»Ÿç”¨æˆ·æ´»åŠ¨æŠ¥å‘Šï¼ŒåŒ…æ‹¬ç™»å½•å†å²ã€ç£ç›˜ä½¿ç”¨ã€è¿›ç¨‹ä¿¡æ¯ç­‰

**å‚æ•°**:
- `USERNAME` (string, å¯é€‰): è¦æŸ¥è¯¢çš„ç”¨æˆ·åï¼Œé»˜è®¤å½“å‰ç”¨æˆ·
- `INCLUDE_PROCESSES` (boolean, å¯é€‰): æ˜¯å¦åŒ…å«è¿›ç¨‹ä¿¡æ¯ï¼Œé»˜è®¤ true
- `INCLUDE_DISK_USAGE` (boolean, å¯é€‰): æ˜¯å¦åŒ…å«ç£ç›˜ä½¿ç”¨ä¿¡æ¯ï¼Œé»˜è®¤ true
- `SAVE_REPORT` (boolean, å¯é€‰): æ˜¯å¦ä¿å­˜æŠ¥å‘Šï¼Œé»˜è®¤ true
- `REPORT_FORMAT` (string, å¯é€‰): æŠ¥å‘Šæ ¼å¼ (txt/html/json)ï¼Œé»˜è®¤ "txt"

**ä½¿ç”¨åœºæ™¯**:
- ç³»ç»Ÿä½¿ç”¨æƒ…å†µç»Ÿè®¡
- ç”¨æˆ·æ´»åŠ¨ç›‘æ§
- èµ„æºä½¿ç”¨åˆ†æ

**ç¤ºä¾‹è¯·æ±‚**:
```
ç”Ÿæˆå½“å‰ç”¨æˆ·çš„æ´»åŠ¨æŠ¥å‘Š
åˆ›å»ºä¸€ä¸ªHTMLæ ¼å¼çš„ç³»ç»ŸæŠ¥å‘Š
```

---

## ğŸ¯ å¦‚ä½•ä½¿ç”¨è¿™äº›ç¤ºä¾‹

### æ–¹æ³•1: é€šè¿‡ AI åŠ©æ‰‹ä½¿ç”¨

è¿™äº›æ¨¡æ¿å·²ç»é›†æˆåˆ°ç³»ç»Ÿä¸­ï¼Œæ‚¨å¯ä»¥ç›´æ¥é€šè¿‡è‡ªç„¶è¯­è¨€ä½¿ç”¨ï¼š

```bash
python src/main.py

# ç„¶åè¾“å…¥ç±»ä¼¼çš„è¯·æ±‚
ğŸ’¬ è¯·è¾“å…¥ > å¸®æˆ‘å¤‡ä»½æ–‡æ¡£æ–‡ä»¶å¤¹åˆ°Dç›˜
```

AI ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä½¿ç”¨ç›¸åº”çš„æ¨¡æ¿ã€‚

### æ–¹æ³•2: ç›´æ¥æ‰§è¡Œ

æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œè¿™äº›è„šæœ¬ï¼ˆéœ€è¦æ‰‹åŠ¨æ›¿æ¢å‚æ•°ï¼‰ï¼š

```powershell
# å¤åˆ¶æ¨¡æ¿
cp templates/custom/examples/simple_backup.ps1 my_backup.ps1

# ç¼–è¾‘å‚æ•°
# å°† {{SOURCE_PATH}} æ›¿æ¢ä¸ºå®é™…è·¯å¾„

# æ‰§è¡Œ
.\my_backup.ps1
```

### æ–¹æ³•3: ä½œä¸ºåˆ›å»ºæ–°æ¨¡æ¿çš„å‚è€ƒ

è¿™äº›ç¤ºä¾‹å±•ç¤ºäº†è‰¯å¥½çš„æ¨¡æ¿ç¼–å†™å®è·µï¼š

- è¯¦ç»†çš„æ³¨é‡Šå’Œæ–‡æ¡£
- æ¸…æ™°çš„å‚æ•°å®šä¹‰
- ç”¨æˆ·å‹å¥½çš„è¾“å‡º
- å®Œå–„çš„é”™è¯¯å¤„ç†
- è¿›åº¦æç¤ºå’Œç»“æœåé¦ˆ

æ‚¨å¯ä»¥å‚è€ƒè¿™äº›ç¤ºä¾‹åˆ›å»ºè‡ªå·±çš„æ¨¡æ¿ï¼š

```bash
python src/main.py template create
```

---

## ğŸ“š å­¦ä¹ è¦ç‚¹

### 1. å‚æ•°å ä½ç¬¦æ ¼å¼

```powershell
# å­—ç¬¦ä¸²å‚æ•°
[string]$Path = "{{PATH}}"

# æ•°å­—å‚æ•°
[int]$Count = {{COUNT}}

# å¸ƒå°”å‚æ•°
[bool]$Enable = ${{ENABLE}}
```

### 2. å‚æ•°éªŒè¯

```powershell
# å¿…éœ€å‚æ•°
[Parameter(Mandatory=$true)]

# å¯é€‰å‚æ•°
[Parameter(Mandatory=$false)]

# å‚æ•°éªŒè¯
[ValidateSet("txt", "html", "json")]
[string]$Format
```

### 3. ç”¨æˆ·å‹å¥½çš„è¾“å‡º

```powershell
# ä½¿ç”¨é¢œè‰²åŒºåˆ†ä¸åŒç±»å‹çš„æ¶ˆæ¯
Write-Host "âœ“ æˆåŠŸ" -ForegroundColor Green
Write-Host "âš ï¸ è­¦å‘Š" -ForegroundColor Yellow
Write-Host "âœ— é”™è¯¯" -ForegroundColor Red
Write-Host "â„¹ï¸ ä¿¡æ¯" -ForegroundColor Cyan
```

### 4. é”™è¯¯å¤„ç†

```powershell
# éªŒè¯è¾“å…¥
if (-not (Test-Path $Path)) {
    Write-Error "è·¯å¾„ä¸å­˜åœ¨: $Path"
    exit 1
}

# Try-Catch å—
try {
    # æ‰§è¡Œæ“ä½œ
} catch {
    Write-Error "æ“ä½œå¤±è´¥: $($_.Exception.Message)"
    exit 1
}
```

### 5. è¿›åº¦åé¦ˆ

```powershell
# æ˜¾ç¤ºè¿›åº¦
Write-Host "å¼€å§‹å¤„ç†..." -ForegroundColor Cyan
# ... æ‰§è¡Œæ“ä½œ ...
Write-Host "âœ“ å¤„ç†å®Œæˆ" -ForegroundColor Green

# æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
Write-Host "  å¤„ç†æ–‡ä»¶æ•°: $count" -ForegroundColor Gray
```

---

## ğŸ”§ è‡ªå®šä¹‰è¿™äº›æ¨¡æ¿

æ‚¨å¯ä»¥åŸºäºè¿™äº›ç¤ºä¾‹åˆ›å»ºè‡ªå·±çš„å˜ä½“ï¼š

### ç¤ºä¾‹ï¼šåˆ›å»ºå¢å¼ºç‰ˆå¤‡ä»½æ¨¡æ¿

```bash
# 1. å¤åˆ¶ç¤ºä¾‹æ¨¡æ¿
cp templates/custom/examples/simple_backup.ps1 templates/custom/my_backups/enhanced_backup.ps1

# 2. ä¿®æ”¹è„šæœ¬ï¼Œæ·»åŠ æ–°åŠŸèƒ½
# - æ·»åŠ é‚®ä»¶é€šçŸ¥
# - æ·»åŠ å¤‡ä»½éªŒè¯
# - æ·»åŠ æ—¥å¿—è®°å½•

# 3. ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·æ³¨å†Œ
python src/main.py template create
# é€‰æ‹©"ä»æ–‡ä»¶å¯¼å…¥"ï¼ŒæŒ‡å‘æ‚¨çš„æ–°è„šæœ¬
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ¸…æ™°çš„æ–‡æ¡£**: ä½¿ç”¨ PowerShell æ³¨é‡Šå— (`<# ... #>`) æä¾›è¯¦ç»†è¯´æ˜
2. **å‚æ•°éªŒè¯**: å§‹ç»ˆéªŒè¯è¾“å…¥å‚æ•°çš„æœ‰æ•ˆæ€§
3. **é”™è¯¯å¤„ç†**: ä½¿ç”¨ try-catch å’Œé€‚å½“çš„é”™è¯¯æ¶ˆæ¯
4. **ç”¨æˆ·åé¦ˆ**: æä¾›æ¸…æ™°çš„è¿›åº¦å’Œç»“æœä¿¡æ¯
5. **çµæ´»æ€§**: ä½¿ç”¨å‚æ•°è€Œä¸æ˜¯ç¡¬ç¼–ç å€¼
6. **å¯æµ‹è¯•æ€§**: æä¾›åˆç†çš„é»˜è®¤å€¼ä¾¿äºæµ‹è¯•

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [è‡ªå®šä¹‰æ¨¡æ¿ç”¨æˆ·æŒ‡å—](../../../docs/custom-template-guide.md)
- [æ¨¡æ¿ç³»ç»Ÿæ¶æ„](../../../docs/architecture.md)
- [PowerShell æœ€ä½³å®è·µ](https://docs.microsoft.com/powershell/scripting/developer/cmdlet/cmdlet-development-guidelines)

---

**æç¤º**: è¿™äº›ç¤ºä¾‹æ¨¡æ¿å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåˆ›å»ºæ‚¨è‡ªå·±æ¨¡æ¿çš„èµ·ç‚¹ã€‚å°è¯•ä¿®æ”¹å®ƒä»¬ä»¥æ»¡è¶³æ‚¨çš„ç‰¹å®šéœ€æ±‚ï¼
