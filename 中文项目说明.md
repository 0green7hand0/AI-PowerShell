# 🤖 AI PowerShell 智能助手

一个基于本地 AI 模型的智能 PowerShell 命令行助手，支持中文自然语言交互。

## 🌟 项目特色

### 🇨🇳 中文支持
- **中文自然语言理解**: 支持中文描述转换为 PowerShell 命令
- **中文文档和注释**: 完整的中文文档和代码注释
- **中文错误提示**: 友好的中文错误信息和建议

### 🔒 安全第一
- **三层安全保护**: 命令白名单 + 权限检查 + 沙箱执行
- **智能风险评估**: 自动识别危险命令并阻止执行
- **完整审计日志**: 记录所有操作，支持追溯和分析

### 🤖 本地 AI 处理
- **隐私保护**: 所有 AI 处理在本地进行，不上传数据
- **多模型支持**: 支持 LLaMA、Ollama 等多种本地 AI 模型
- **智能学习**: 根据使用历史优化命令生成

### 🌐 跨平台兼容
- **Windows**: 支持 PowerShell 5.1 和 PowerShell Core
- **Linux**: 完整支持 PowerShell Core
- **macOS**: 原生支持 PowerShell Core

## 🚀 快速体验

### 1. 一键安装
```bash
# Linux/macOS 自动安装
curl -fsSL https://raw.githubusercontent.com/0green7hand0/AI-PowerShell/main/scripts/install.sh | bash

# Windows PowerShell 安装
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/0green7hand0/AI-PowerShell/main/scripts/install.ps1" -OutFile "install.ps1"
.\install.ps1
```

### 2. 启动服务
```bash
# 启动 AI PowerShell 助手
powershell-assistant start

# 或使用 Docker
docker-compose up -d
```

### 3. 中文交互示例
```python
# 使用中文客户端
python examples/中文使用示例.py

# 或直接 API 调用
curl -X POST http://localhost:8000/natural_language_to_powershell \
  -H "Content-Type: application/json" \
  -d '{"input_text": "显示CPU使用率最高的5个进程"}'
```

## 📖 中文使用示例

### 系统管理
```python
助手 = PowerShellAssistant()

# 中文描述，自动转换为 PowerShell 命令
助手.智能对话("显示内存使用超过500MB的进程")
助手.智能对话("检查磁盘空间使用情况") 
助手.智能对话("列出所有正在运行的服务")
助手.智能对话("查看系统启动时间")
```

### 文件操作
```python
# 文件管理任务
助手.智能对话("列出当前目录下的所有.txt文件")
助手.智能对话("创建一个名为'备份'的文件夹")
助手.智能对话("查找大于100MB的文件")
助手.智能对话("显示文件夹权限设置")
```

### 网络诊断
```python
# 网络相关任务
助手.智能对话("测试到百度的网络连接")
助手.智能对话("显示本机所有IP地址")
助手.智能对话("查看网络适配器状态")
助手.智能对话("显示当前网络连接")
```

## 🏗️ 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                    🌐 用户接口层                              │
├─────────────────┬─────────────────┬─────────────────────────┤
│   🖥️ Web界面    │   📱 移动端     │   🔧 命令行工具          │
└─────────────────┴─────────────────┴─────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                   📡 MCP 服务器核心                          │
│  ┌─────────────┬─────────────┬─────────────┬─────────────┐   │
│  │ 自然语言工具 │ 命令执行工具 │ 系统信息工具 │ 自定义工具   │   │
│  └─────────────┴─────────────┴─────────────┴─────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                   🧠 核心处理层                              │
│  ┌─────────────┬─────────────┬─────────────┬─────────────┐   │
│  │  🤖 AI引擎  │  🔒 安全引擎 │  ⚡ 执行引擎 │  📊 日志引擎 │   │
│  └─────────────┴─────────────┴─────────────┴─────────────┘   │
└─────────────────────────────────────────────────────────────┘
                            │
┌─────────────────────────────────────────────────────────────┐
│                   💾 数据存储层                              │
│  ┌─────────────┬─────────────┬─────────────┬─────────────┐   │
│  │  📁 文件存储 │  🗃️ 配置管理 │  📈 历史记录 │  🔍 审计日志 │   │
│  └─────────────┴─────────────┴─────────────┴─────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

## 🔧 核心组件详解

### 🤖 AI 引擎 (AI Engine)
- **功能**: 中文自然语言到 PowerShell 命令转换
- **特点**: 本地处理，支持多种 AI 模型
- **文件**: `src/ai_engine/`

### 🔒 安全引擎 (Security Engine)  
- **功能**: 三层安全验证和沙箱执行
- **特点**: 智能风险评估，可配置安全规则
- **文件**: `src/security/`

### ⚡ 执行引擎 (Execution Engine)
- **功能**: 跨平台 PowerShell 命令执行
- **特点**: 平台适配，输出格式化
- **文件**: `src/execution/`

### 📊 日志引擎 (Logging Engine)
- **功能**: 全面的审计跟踪和性能监控
- **特点**: 关联追踪，多种输出格式
- **文件**: `src/log_engine/`

### 💾 存储引擎 (Storage Engine)
- **功能**: 配置管理和数据持久化
- **特点**: 支持备份，版本控制
- **文件**: `src/storage/`

### 🧠 上下文管理 (Context Manager)
- **功能**: 会话管理和历史记录
- **特点**: 智能上下文维护
- **文件**: `src/context/`

## 📚 中文文档结构

```
docs/
├── 中文文档/
│   ├── 用户指南.md          # 用户使用指南
│   ├── 安装说明.md          # 详细安装步骤
│   ├── 配置指南.md          # 配置选项说明
│   ├── API参考.md           # API 接口文档
│   ├── 故障排除.md          # 常见问题解决
│   └── 常见问题.md          # FAQ
├── examples/
│   ├── 中文使用示例.py      # 中文交互示例
│   ├── 系统管理示例.py      # 系统管理任务
│   └── 网络诊断示例.py      # 网络诊断工具
└── config/
    └── 中文配置说明.md      # 配置文件详解
```

## 🎯 使用场景

### 👨‍💼 系统管理员
```python
# 日常运维任务
"检查服务器CPU和内存使用情况"
"重启IIS应用程序池"
"清理临时文件和日志"
"监控磁盘空间使用"
"查看系统错误日志"
```

### 👨‍💻 开发者
```python
# 开发环境管理
"停止所有node.js进程"
"检查端口8080是否被占用"
"启动本地数据库服务"
"清理项目构建缓存"
"查看Git仓库状态"
```

### 🔒 安全专家
```python
# 安全审计任务
"显示最近登录失败的用户"
"检查防火墙规则配置"
"查看系统安全事件日志"
"监控网络连接状态"
"检查用户权限设置"
```

### 📊 数据分析师
```python
# 数据处理任务
"导出CSV格式的进程信息"
"统计日志文件中的错误数量"
"分析系统性能数据"
"生成资源使用报告"
"清理和整理数据文件"
```

## 🛠️ 开发和定制

### 添加自定义命令模板
```python
# 在 src/ai_engine/translation.py 中添加
中文命令模板 = {
    "进程管理": {
        "显示进程": "Get-Process",
        "结束进程": "Stop-Process -Name {进程名}",
        "进程排序": "Get-Process | Sort-Object {排序字段} -Descending"
    },
    "服务管理": {
        "查看服务": "Get-Service",
        "启动服务": "Start-Service -Name {服务名}",
        "停止服务": "Stop-Service -Name {服务名}"
    }
}
```

### 自定义安全规则
```yaml
# config/security-rules.yaml
custom_rules:
  - name: "允许公司脚本"
    pattern: ".*\\公司脚本\\.*"
    action: "allow"
    description: "允许执行公司批准的脚本"
  
  - name: "阻止危险删除"
    pattern: "Remove-Item.*重要文件"
    action: "block"
    description: "阻止删除重要文件"
```

## 📈 性能优化

### AI 模型优化
```yaml
# 根据硬件配置调整
ai_model:
  # CPU 优化
  threads: 8              # CPU 线程数
  batch_size: 4           # 批处理大小
  
  # GPU 优化  
  gpu_layers: 32          # GPU 层数
  context_length: 2048    # 上下文长度
  
  # 内存优化
  temperature: 0.7        # 创造性参数
  max_tokens: 256         # 最大生成长度
```

### 系统性能监控
```python
# 性能监控示例
助手.智能对话("显示系统资源使用情况")
助手.智能对话("监控AI助手进程的CPU和内存使用")
助手.智能对话("检查磁盘I/O性能")
助手.智能对话("分析网络带宽使用")
```

## 🤝 社区和支持

### 获取帮助
- 📖 **文档**: 查看 `docs/中文文档/` 目录
- 🐛 **问题报告**: GitHub Issues
- 💬 **讨论交流**: GitHub Discussions
- 📧 **邮件支持**: support@example.com

### 贡献代码
1. Fork 项目仓库
2. 创建功能分支
3. 提交代码更改
4. 创建 Pull Request

### 社区规范
- 使用中文进行交流
- 提供详细的问题描述
- 遵循代码规范
- 尊重其他贡献者

## 📄 许可证

本项目采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 🙏 致谢

感谢以下开源项目的支持：
- [FastMCP](https://github.com/jlowin/fastmcp) - MCP 协议实现
- [LLaMA.cpp](https://github.com/ggerganov/llama.cpp) - 本地 AI 模型运行
- [PowerShell](https://github.com/PowerShell/PowerShell) - 跨平台 PowerShell
- [Docker](https://www.docker.com/) - 容器化部署

---

**🚀 开始使用 AI PowerShell 智能助手，让命令行操作更加智能和高效！**
