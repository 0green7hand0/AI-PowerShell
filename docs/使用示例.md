# 使用示例

## 版本选择

### 实用版本.py - 适合个人用户

**特点**: 单文件运行，简单易用，快速上手
**适用场景**: 个人学习、快速体验、日常使用

```bash
# 启动实用版本
python 实用版本.py
```

### 最终修复版本.py - 适合企业用户

**特点**: 完整架构，功能全面，安全性高
**适用场景**: 企业环境、生产使用、高级功能需求

```bash
# 启动企业版本
python 最终修复版本.py
```

## 基本使用流程

### 1. 启动程序

```bash
# 选择合适的版本启动
python 实用版本.py
# 或
python 最终修复版本.py
```

### 2. 交互式使用

程序启动后，您可以用中文描述需求：

```
AI PowerShell 助手已启动
请输入您的需求（输入 'quit' 退出）：

> 显示所有正在运行的进程
生成的 PowerShell 命令: Get-Process
是否执行此命令？(y/n): y
[执行结果显示进程列表]

> 检查磁盘空间使用情况
生成的 PowerShell 命令: Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, Size, FreeSpace
是否执行此命令？(y/n): y
[执行结果显示磁盘使用情况]
```

## 实际使用案例

### 案例 1: 系统监控

**需求**: 监控系统性能和资源使用

```
用户输入: "显示CPU使用率最高的5个进程"
系统生成: Get-Process | Sort-Object CPU -Descending | Select-Object -First 5
执行结果: 显示CPU占用最高的进程列表

用户输入: "检查内存使用情况"
系统生成: Get-WmiObject -Class Win32_OperatingSystem | Select-Object TotalVisibleMemorySize, FreePhysicalMemory
执行结果: 显示内存使用统计

用户输入: "查看网络连接状态"
系统生成: Get-NetTCPConnection | Where-Object {$_.State -eq "Established"}
执行结果: 显示活动的网络连接
```

### 案例 2: 文件管理

**需求**: 管理文件和目录

```
用户输入: "列出当前目录下的所有文件"
系统生成: Get-ChildItem -Path .
执行结果: 显示当前目录文件列表

用户输入: "查找大于100MB的文件"
系统生成: Get-ChildItem -Recurse | Where-Object {$_.Length -gt 100MB}
执行结果: 显示大文件列表

用户输入: "创建一个名为backup的文件夹"
系统生成: New-Item -ItemType Directory -Name "backup"
执行结果: 创建backup目录
```

### 案例 3: 服务管理

**需求**: 管理Windows服务

```
用户输入: "显示所有正在运行的服务"
系统生成: Get-Service | Where-Object {$_.Status -eq "Running"}
执行结果: 显示运行中的服务列表

用户输入: "检查Windows Update服务状态"
系统生成: Get-Service -Name "wuauserv"
执行结果: 显示Windows Update服务状态

用户输入: "列出所有停止的服务"
系统生成: Get-Service | Where-Object {$_.Status -eq "Stopped"}
执行结果: 显示已停止的服务列表
```

### 案例 4: 网络诊断

**需求**: 网络连接和诊断

```
用户输入: "测试到百度的网络连接"
系统生成: Test-NetConnection -ComputerName "baidu.com" -Port 80
执行结果: 显示网络连接测试结果

用户输入: "显示本机IP地址"
系统生成: Get-NetIPAddress | Where-Object {$_.AddressFamily -eq "IPv4"}
执行结果: 显示IPv4地址信息

用户输入: "查看DNS设置"
系统生成: Get-DnsClientServerAddress
执行结果: 显示DNS服务器配置
```

### 案例 5: 系统信息

**需求**: 获取系统详细信息

```
用户输入: "显示系统基本信息"
系统生成: Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, TotalPhysicalMemory
执行结果: 显示系统基本信息

用户输入: "查看已安装的软件列表"
系统生成: Get-WmiObject -Class Win32_Product | Select-Object Name, Version
执行结果: 显示已安装软件

用户输入: "检查系统启动时间"
系统生成: Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object LastBootUpTime
执行结果: 显示系统启动时间
```

## 高级功能示例

### 批量操作

```
用户输入: "批量重命名txt文件为bak文件"
系统生成: Get-ChildItem *.txt | Rename-Item -NewName {$_.Name -replace '.txt','.bak'}
执行结果: 批量重命名文件

用户输入: "删除所有临时文件"
系统生成: Get-ChildItem -Path $env:TEMP -Recurse | Remove-Item -Force -Recurse
执行结果: 清理临时文件（需要确认）
```

### 定时任务

```
用户输入: "创建每天备份文档的计划任务"
系统生成: Register-ScheduledTask -TaskName "DailyBackup" -Trigger (New-ScheduledTaskTrigger -Daily -At 2AM) -Action (New-ScheduledTaskAction -Execute "PowerShell" -Argument "Copy-Item C:\Documents D:\Backup -Recurse")
执行结果: 创建计划任务

用户输入: "查看所有计划任务"
系统生成: Get-ScheduledTask
执行结果: 显示计划任务列表
```

### 性能分析

```
用户输入: "分析系统性能计数器"
系统生成: Get-Counter "\Processor(_Total)\% Processor Time"
执行结果: 显示CPU使用率

用户输入: "监控磁盘IO性能"
系统生成: Get-Counter "\PhysicalDisk(_Total)\Disk Reads/sec", "\PhysicalDisk(_Total)\Disk Writes/sec"
执行结果: 显示磁盘IO统计
```

## 安全注意事项

### 命令确认

系统会在执行命令前要求确认：

```
生成的 PowerShell 命令: Remove-Item C:\temp\* -Recurse
⚠️  警告: 此命令可能删除文件，请仔细确认
是否执行此命令？(y/n): 
```

### 危险操作提示

对于可能影响系统的操作，系统会特别提醒：

```
用户输入: "格式化D盘"
系统提示: ⚠️ 危险操作：此命令将删除所有数据
建议: 请在测试环境中验证，或手动执行
生成的命令: Format-Volume -DriveLetter D -FileSystem NTFS
```

### 权限管理

某些操作需要管理员权限：

```
用户输入: "安装Windows更新"
系统提示: ℹ️ 此操作需要管理员权限
建议: 以管理员身份运行PowerShell
生成的命令: Install-WindowsUpdate -AcceptAll
```

## 使用技巧

### 1. 描述要清晰具体

```
❌ 不好的描述: "看看文件"
✅ 好的描述: "列出当前目录下的所有PDF文件"

❌ 不好的描述: "检查网络"
✅ 好的描述: "测试到google.com的网络连接"
```

### 2. 善用中文描述

```
✅ "显示所有正在运行的进程"
✅ "检查磁盘空间使用情况"
✅ "列出Windows服务状态"
✅ "查找大于1GB的文件"
```

### 3. 分步骤操作

对于复杂任务，建议分步骤进行：

```
步骤1: "创建备份目录"
步骤2: "复制重要文件到备份目录"
步骤3: "压缩备份目录"
```

### 4. 验证结果

执行命令后，可以用相关命令验证结果：

```
执行: "创建test文件夹"
验证: "检查test文件夹是否存在"
```

## 故障排除

### 常见问题

**问题**: 生成的命令不正确
**解决**: 尝试更详细地描述需求，或者分解为更简单的步骤

**问题**: 命令执行失败
**解决**: 检查权限、路径、参数是否正确

**问题**: 程序无响应
**解决**: 重启程序，检查系统资源使用情况

### 获取帮助

1. 查看 [常见问题](常见问题.md)
2. 阅读 [安装指南](安装指南.md)
3. 访问 [GitHub Issues](https://github.com/0green7hand0/AI-PowerShell/issues)

## 最佳实践

1. **先测试后执行**: 对于重要操作，先在测试环境验证
2. **定期备份**: 在进行系统级操作前备份重要数据
3. **权限最小化**: 只在必要时使用管理员权限
4. **命令理解**: 执行前理解生成的PowerShell命令含义
5. **日志记录**: 保留重要操作的执行记录

通过这些示例和技巧，您可以更好地使用 AI PowerShell 智能助手来提高工作效率！