# 常见问题

## 安装相关问题

### Q1: Python 版本要求是什么？

**A**: 需要 Python 3.8 或更高版本。

检查当前版本：
```bash
python --version
```

如果版本过低，请从 [python.org](https://www.python.org/downloads/) 下载最新版本。

### Q2: 安装脚本执行失败怎么办？

**A**: 常见解决方案：

**Windows PowerShell**:
```powershell
# 设置执行策略
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 以管理员身份运行
.\scripts\install.ps1
```

**Linux/macOS**:
```bash
# 添加执行权限
chmod +x scripts/install.sh

# 使用 sudo 运行
sudo bash scripts/install.sh
```

### Q3: pip install 依赖失败

**A**: 尝试以下解决方案：

```bash
# 1. 升级 pip
python -m pip install --upgrade pip

# 2. 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/

# 3. 清理缓存重试
pip cache purge
pip install -r requirements.txt
```

### Q4: PowerShell 未找到错误

**A**: 确保 PowerShell 已正确安装：

**Windows**: 
- Windows 10/11 自带 PowerShell 5.1
- 推荐安装 PowerShell Core 7.x

**Linux**:
```bash
# Ubuntu/Debian
sudo apt-get update && sudo apt-get install -y powershell

# CentOS/RHEL
sudo yum install -y powershell
```

**macOS**:
```bash
# 使用 Homebrew
brew install powershell
```

## 使用相关问题

### Q5: 程序启动后没有响应

**A**: 检查以下几点：

1. **确认 Python 版本**:
```bash
python --version  # 应该是 3.8+
```

2. **检查依赖是否完整**:
```bash
pip list | grep -E "(requests|json)"
```

3. **查看错误信息**:
```bash
python 实用版本.py --verbose
```

4. **重新安装依赖**:
```bash
pip install -r requirements.txt --force-reinstall
```

### Q6: 生成的 PowerShell 命令不正确

**A**: 改进输入描述：

**❌ 不好的描述**:
- "看看文件"
- "检查网络"
- "删除东西"

**✅ 好的描述**:
- "列出当前目录下的所有 PDF 文件"
- "测试到 google.com 的网络连接"
- "删除桌面上的临时文件"

### Q7: 命令执行失败

**A**: 常见原因和解决方案：

**权限不足**:
```bash
# 以管理员身份运行 PowerShell
# Windows: 右键 PowerShell -> 以管理员身份运行
```

**路径不存在**:
```bash
# 确认路径是否正确
Test-Path "C:\your\path"
```

**参数错误**:
```bash
# 检查生成的命令语法
Get-Help CommandName -Examples
```

### Q8: 如何选择合适的版本？

**A**: 版本选择指南：

**实用版本.py**:
- ✅ 个人用户
- ✅ 快速体验
- ✅ 学习使用
- ✅ 简单任务

**最终修复版本.py**:
- ✅ 企业环境
- ✅ 生产使用
- ✅ 复杂任务
- ✅ 高级功能

## 功能相关问题

### Q9: 支持哪些类型的 PowerShell 命令？

**A**: 支持大部分常用 PowerShell 命令：

**系统管理**:
- 进程管理: `Get-Process`, `Stop-Process`
- 服务管理: `Get-Service`, `Start-Service`
- 文件操作: `Get-ChildItem`, `Copy-Item`

**网络诊断**:
- 连接测试: `Test-NetConnection`
- IP 配置: `Get-NetIPAddress`
- DNS 查询: `Resolve-DnsName`

**性能监控**:
- 性能计数器: `Get-Counter`
- 系统信息: `Get-ComputerInfo`
- WMI 查询: `Get-WmiObject`

### Q10: 是否支持复杂的脚本生成？

**A**: 当前版本主要支持单行命令，对于复杂脚本建议：

1. **分步骤执行**:
```
步骤1: "创建备份目录"
步骤2: "复制文件到备份目录"  
步骤3: "压缩备份文件"
```

2. **使用管道组合**:
```
"获取CPU使用率最高的5个进程并保存到文件"
```

### Q11: 如何处理需要交互的命令？

**A**: 对于需要用户交互的命令：

1. **使用 -Force 参数**:
```powershell
Remove-Item -Path "C:\temp" -Recurse -Force
```

2. **使用 -Confirm:$false**:
```powershell
Stop-Service -Name "ServiceName" -Confirm:$false
```

3. **分步骤确认**:
```
先执行: "检查要删除的文件列表"
再执行: "删除确认的文件"
```

## 安全相关问题

### Q12: 执行命令是否安全？

**A**: 系统提供多层安全保护：

1. **命令预览**: 执行前显示生成的命令
2. **用户确认**: 需要手动确认才执行
3. **危险提示**: 对危险操作特别警告
4. **权限检查**: 提示需要的权限级别

### Q13: 如何避免误操作？

**A**: 安全使用建议：

1. **仔细阅读生成的命令**
2. **对重要操作先备份**
3. **在测试环境验证**
4. **使用 -WhatIf 参数预览**:
```powershell
Remove-Item -Path "C:\temp\*" -Recurse -WhatIf
```

### Q14: 可以撤销已执行的命令吗？

**A**: 大部分命令无法直接撤销，建议：

1. **预防措施**:
   - 执行前备份重要数据
   - 使用 -WhatIf 参数预览
   - 在测试环境先验证

2. **恢复方法**:
   - 从备份恢复数据
   - 使用系统还原点
   - 重新创建被删除的内容

## 性能相关问题

### Q15: 程序运行很慢怎么办？

**A**: 性能优化建议：

1. **检查系统资源**:
```bash
# 检查内存使用
python -c "import psutil; print(f'内存使用: {psutil.virtual_memory().percent}%')"
```

2. **关闭不必要的程序**
3. **使用实用版本** (更轻量)
4. **增加系统内存**

### Q16: AI 响应时间长

**A**: 可能的原因和解决方案：

1. **网络连接问题**: 检查网络连接
2. **系统资源不足**: 关闭其他程序
3. **输入过于复杂**: 简化描述
4. **首次运行**: 首次运行需要初始化

## 兼容性问题

### Q17: 支持哪些操作系统？

**A**: 支持的操作系统：

- ✅ Windows 10/11
- ✅ Windows Server 2016+
- ✅ Ubuntu 18.04+
- ✅ CentOS 7+
- ✅ macOS 10.15+

### Q18: PowerShell 版本兼容性

**A**: PowerShell 版本支持：

- ✅ PowerShell Core 7.0+ (推荐)
- ✅ Windows PowerShell 5.1
- ⚠️ PowerShell 6.x (部分功能)
- ❌ PowerShell 5.0 及以下

### Q19: 在 Linux/macOS 上使用有限制吗？

**A**: 跨平台使用注意事项：

1. **命令差异**: 某些 Windows 特定命令不可用
2. **路径格式**: 使用对应系统的路径格式
3. **权限模型**: Linux/macOS 使用不同的权限系统
4. **服务管理**: 使用 systemctl 而非 Windows 服务

## 故障排除

### Q20: 如何获取详细的错误信息？

**A**: 启用详细日志：

```bash
# 启用详细模式
python 实用版本.py --verbose --debug

# 查看日志文件（如果存在）
tail -f logs/app.log
```

### Q21: 重置到初始状态

**A**: 完全重置步骤：

```bash
# 1. 删除虚拟环境
rm -rf venv/

# 2. 清理 Python 缓存
find . -name "__pycache__" -exec rm -rf {} +
find . -name "*.pyc" -delete

# 3. 重新安装
pip install -r requirements.txt
```

### Q22: 联系技术支持

**A**: 获取帮助的途径：

1. **GitHub Issues**: [提交问题](https://github.com/0green7hand0/AI-PowerShell/issues)
2. **GitHub Discussions**: [参与讨论](https://github.com/0green7hand0/AI-PowerShell/discussions)
3. **文档**: 查看 [项目文档](../README.md)

**提交问题时请包含**:
- 操作系统和版本
- Python 版本
- 错误信息截图
- 重现步骤
- 期望的结果

## 更新和维护

### Q23: 如何更新到最新版本？

**A**: 更新步骤：

```bash
# 1. 备份当前配置
cp -r . ../ai-powershell-backup

# 2. 拉取最新代码
git pull origin main

# 3. 更新依赖
pip install -r requirements.txt --upgrade

# 4. 测试功能
python 实用版本.py --test
```

### Q24: 如何备份和恢复配置？

**A**: 备份重要文件：

```bash
# 备份配置文件（如果存在）
cp config.json config.json.backup

# 备份自定义脚本
cp -r custom/ custom.backup/

# 恢复时
cp config.json.backup config.json
```

---

如果您的问题没有在这里找到答案，请：

1. 查看 [安装指南](安装指南.md)
2. 阅读 [使用示例](使用示例.md)
3. 访问 [GitHub Issues](https://github.com/0green7hand0/AI-PowerShell/issues)
4. 提交新的问题描述