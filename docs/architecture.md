<!-- æ–‡æ¡£ç±»å‹: å¼€å‘è€…æ–‡æ¡£ | æœ€åæ›´æ–°: 2025-10-17 | ç»´æŠ¤è€…: é¡¹ç›®å›¢é˜Ÿ -->

# AI PowerShell æ™ºèƒ½åŠ©æ‰‹ - ç³»ç»Ÿæ¶æ„æ–‡æ¡£

> **æ–‡æ¡£ç±»å‹**: å¼€å‘è€…æ–‡æ¡£ | **æœ€åæ›´æ–°**: 2025-10-17 | **ç»´æŠ¤è€…**: é¡¹ç›®å›¢é˜Ÿ

ğŸ“ [é¦–é¡µ](../README.md) > [æ–‡æ¡£ä¸­å¿ƒ](README.md) > ç³»ç»Ÿæ¶æ„æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
- [æ•´ä½“æ¶æ„](#æ•´ä½“æ¶æ„)
- [æ ¸å¿ƒæ¨¡å—è¯¦è§£](#æ ¸å¿ƒæ¨¡å—è¯¦è§£)
- [æ•°æ®æµ](#æ•°æ®æµ)
- [è®¾è®¡æ¨¡å¼](#è®¾è®¡æ¨¡å¼)
- [æ‰©å±•ç‚¹](#æ‰©å±•ç‚¹)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [å®‰å…¨è€ƒè™‘](#å®‰å…¨è€ƒè™‘)
- [æµ‹è¯•ç­–ç•¥](#æµ‹è¯•ç­–ç•¥)
- [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)

---

## ç³»ç»Ÿæ¦‚è¿°

AI PowerShell æ™ºèƒ½åŠ©æ‰‹æ˜¯ä¸€ä¸ªåŸºäºæœ¬åœ° AI æ¨¡å‹çš„æ™ºèƒ½å‘½ä»¤è¡ŒåŠ©æ‰‹ï¼Œé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œæ”¯æŒä¸­æ–‡è‡ªç„¶è¯­è¨€äº¤äº’ï¼Œæä¾›ä¸‰å±‚å®‰å…¨ä¿æŠ¤æœºåˆ¶ã€‚

### è®¾è®¡ç›®æ ‡

1. **æ¨¡å—åŒ–**: é‡‡ç”¨é«˜å†…èšä½è€¦åˆçš„æ¨¡å—åŒ–æ¶æ„ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
2. **ç®€æ´æ€§**: æä¾›ç®€å•æ˜“ç”¨çš„ç”¨æˆ·ç•Œé¢å’Œæ¸…æ™°çš„ä»£ç ç»“æ„
3. **å®‰å…¨æ€§**: å®æ–½ä¸‰å±‚å®‰å…¨ä¿æŠ¤ï¼Œç¡®ä¿å‘½ä»¤æ‰§è¡Œçš„å®‰å…¨æ€§
4. **éšç§ä¿æŠ¤**: æ‰€æœ‰ AI å¤„ç†åœ¨æœ¬åœ°è¿›è¡Œï¼Œä¸ä¸Šä¼ ç”¨æˆ·æ•°æ®
5. **è·¨å¹³å°**: æ”¯æŒ Windowsã€Linux å’Œ macOS
6. **å¯æ‰©å±•æ€§**: æ”¯æŒæ·»åŠ è‡ªå®šä¹‰è§„åˆ™å’Œé›†æˆä¸åŒçš„ AI æ¨¡å‹

### æ ¸å¿ƒç‰¹æ€§

- ä¸­æ–‡è‡ªç„¶è¯­è¨€åˆ° PowerShell å‘½ä»¤çš„æ™ºèƒ½è½¬æ¢
- åŸºäºè§„åˆ™åŒ¹é…å’Œ AI æ¨¡å‹çš„æ··åˆç¿»è¯‘ç­–ç•¥
- æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œé«˜å†…èšä½è€¦åˆ
- ä¸‰å±‚å®‰å…¨éªŒè¯ï¼šå‘½ä»¤ç™½åå•ã€æƒé™æ£€æŸ¥ã€æ²™ç®±æ‰§è¡Œ
- è·¨å¹³å° PowerShell æ”¯æŒï¼ˆPowerShell 5.1 å’Œ PowerShell Coreï¼‰
- å®Œæ•´çš„å®¡è®¡æ—¥å¿—å’Œæ€§èƒ½ç›‘æ§
- æœ¬åœ° AI æ¨¡å‹é›†æˆï¼ˆLLaMAã€Ollama ç­‰ï¼‰
- ä¼šè¯ç®¡ç†å’Œå‘½ä»¤å†å²è®°å½•
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„æ™ºèƒ½ç¿»è¯‘

---

## æ•´ä½“æ¶æ„

### æ¶æ„å±‚æ¬¡å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ¥å£å±‚ (User Interface)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å‘½ä»¤è¡Œç•Œé¢   â”‚  äº¤äº’æ¨¡å¼    â”‚  Python API                 â”‚ â”‚
â”‚  â”‚   (CLI)     â”‚ (Interactive)â”‚  (API)                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ ¸å¿ƒå¤„ç†å±‚ (Core Processing)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           PowerShellAssistant (ä¸»æ§åˆ¶å™¨)              â”‚   â”‚
â”‚  â”‚  - åè°ƒå„ç»„ä»¶å·¥ä½œ                                      â”‚   â”‚
â”‚  â”‚  - ç®¡ç†è¯·æ±‚å¤„ç†æµç¨‹                                    â”‚   â”‚
â”‚  â”‚  - æä¾›ç»Ÿä¸€çš„æ¥å£                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI å¼•æ“      â”‚   â”‚  å®‰å…¨å¼•æ“     â”‚   â”‚  æ‰§è¡Œå¼•æ“     â”‚
â”‚ (AI Engine)  â”‚   â”‚(Security Eng.)â”‚   â”‚(Exec Engine) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ”¯æŒæ¨¡å—å±‚ (Support Modules)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  é…ç½®ç®¡ç†    â”‚  æ—¥å¿—å¼•æ“    â”‚  å­˜å‚¨å¼•æ“    â”‚  ä¸Šä¸‹æ–‡ç®¡ç†  â”‚   â”‚
â”‚  â”‚  (Config)   â”‚  (Logging)  â”‚  (Storage)  â”‚  (Context)  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—åŒ–æ¶æ„

é¡¹ç›®é‡‡ç”¨é«˜å†…èšä½è€¦åˆçš„æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼š

**æ¶æ„ç‰¹ç‚¹**:
- æ¸…æ™°çš„æ¨¡å—åˆ’åˆ†ï¼Œæ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€
- æ¨¡å—é—´é€šè¿‡æ¥å£é€šä¿¡ï¼Œé™ä½è€¦åˆ
- æ”¯æŒå¤šç§ AI æ¨¡å‹é›†æˆ
- å®Œæ•´çš„ä¸‰å±‚å®‰å…¨ä¿æŠ¤
- æ²™ç®±æ‰§è¡Œæ”¯æŒ
- å®Œæ•´çš„æ—¥å¿—å’Œå®¡è®¡ç³»ç»Ÿ

**æ¨¡å—ç»“æ„**:
```
src/
â”œâ”€â”€ interfaces/          # æ¥å£å®šä¹‰å±‚
â”‚   â””â”€â”€ base.py         # åŸºç¡€æ¥å£å’Œæ•°æ®æ¨¡å‹
â”œâ”€â”€ ai_engine/          # AI å¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ engine.py       # AI å¼•æ“ä¸»ç±»
â”‚   â”œâ”€â”€ translation.py  # ç¿»è¯‘é€»è¾‘
â”‚   â”œâ”€â”€ providers.py    # AI æä¾›å•†
â”‚   â””â”€â”€ error_detection.py  # é”™è¯¯æ£€æµ‹
â”œâ”€â”€ security/           # å®‰å…¨å¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ engine.py       # å®‰å…¨å¼•æ“ä¸»ç±»
â”‚   â”œâ”€â”€ whitelist.py    # å‘½ä»¤ç™½åå•
â”‚   â”œâ”€â”€ permissions.py  # æƒé™æ£€æŸ¥
â”‚   â””â”€â”€ sandbox.py      # æ²™ç®±æ‰§è¡Œ
â”œâ”€â”€ execution/          # æ‰§è¡Œå¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ executor.py     # æ‰§è¡Œå™¨ä¸»ç±»
â”‚   â”œâ”€â”€ platform_adapter.py  # å¹³å°é€‚é…
â”‚   â””â”€â”€ output_formatter.py  # è¾“å‡ºæ ¼å¼åŒ–
â”œâ”€â”€ config/             # é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ manager.py      # é…ç½®ç®¡ç†å™¨
â”‚   â””â”€â”€ models.py       # é…ç½®æ•°æ®æ¨¡å‹
â”œâ”€â”€ log_engine/         # æ—¥å¿—å¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ engine.py       # æ—¥å¿—å¼•æ“ä¸»ç±»
â”‚   â”œâ”€â”€ decorators.py   # æ—¥å¿—è£…é¥°å™¨
â”‚   â””â”€â”€ filters.py      # æ—¥å¿—è¿‡æ»¤å™¨
â”œâ”€â”€ storage/            # å­˜å‚¨å¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ interfaces.py   # å­˜å‚¨æ¥å£
â”‚   â”œâ”€â”€ file_storage.py # æ–‡ä»¶å­˜å‚¨å®ç°
â”‚   â””â”€â”€ factory.py      # å­˜å‚¨å·¥å‚
â”œâ”€â”€ context/            # ä¸Šä¸‹æ–‡ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ manager.py      # ä¸Šä¸‹æ–‡ç®¡ç†å™¨
â”‚   â”œâ”€â”€ history.py      # å†å²è®°å½•
â”‚   â””â”€â”€ models.py       # ä¸Šä¸‹æ–‡æ•°æ®æ¨¡å‹
â””â”€â”€ main.py             # ä¸»å…¥å£æ–‡ä»¶
```

---

## æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. ä¸»æ§åˆ¶å™¨ (PowerShellAssistant)

**ä½ç½®**: `src/main.py`

**èŒè´£**: ç³»ç»Ÿæ ¸å¿ƒï¼Œåè°ƒæ‰€æœ‰æ¨¡å—å·¥ä½œï¼Œç®¡ç†è¯·æ±‚å¤„ç†æµç¨‹

**æ ¸å¿ƒåŠŸèƒ½**:
- åˆå§‹åŒ–å’Œç®¡ç†æ‰€æœ‰å­æ¨¡å—
- å¤„ç†ç”¨æˆ·è¯·æ±‚çš„å®Œæ•´æµç¨‹
- æä¾›äº¤äº’å¼å’Œå‘½ä»¤è¡Œä¸¤ç§ä½¿ç”¨æ¨¡å¼
- ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†

**åˆå§‹åŒ–æµç¨‹**:
```python
def __init__(self, config_path: Optional[str] = None):
    # 1. åŠ è½½é…ç½®
    self.config_manager = ConfigManager(config_path)
    self.config = self.config_manager.load_config()
    
    # 2. åˆå§‹åŒ–æ—¥å¿—å¼•æ“
    self.log_engine = LogEngine(self.config.logging)
    
    # 3. åˆå§‹åŒ–å­˜å‚¨å¼•æ“
    self.storage = StorageFactory.create_storage(...)
    
    # 4. åˆå§‹åŒ–ä¸Šä¸‹æ–‡ç®¡ç†å™¨
    self.context_manager = ContextManager(storage=self.storage)
    
    # 5. åˆå§‹åŒ– AI å¼•æ“
    self.ai_engine = AIEngine(self.config.ai.model_dump())
    
    # 6. åˆå§‹åŒ–å®‰å…¨å¼•æ“
    self.security_engine = SecurityEngine(self.config.security.model_dump())
    
    # 7. åˆå§‹åŒ–æ‰§è¡Œå¼•æ“
    self.executor = CommandExecutor(self.config.execution.model_dump())
```

**å…³é”®æ–¹æ³•**:
- `process_request()`: å¤„ç†ç”¨æˆ·è¯·æ±‚çš„å®Œæ•´æµç¨‹
- `interactive_mode()`: å¯åŠ¨äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢
- `_build_context()`: æ„å»ºå½“å‰ä¸Šä¸‹æ–‡
- `_get_user_confirmation()`: è·å–ç”¨æˆ·ç¡®è®¤

**ç‰¹ç‚¹**:
- ä¾èµ–æ³¨å…¥æ¨¡å¼ï¼Œå„æ¨¡å—æ¾è€¦åˆ
- å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- æ”¯æŒè‡ªåŠ¨æ‰§è¡Œå’Œç”¨æˆ·ç¡®è®¤ä¸¤ç§æ¨¡å¼
- ä½¿ç”¨å…³è” ID è¿½è¸ªè¯·æ±‚ç”Ÿå‘½å‘¨æœŸ

---

### 2. æ¥å£å®šä¹‰å±‚ (Interfaces)

**ä½ç½®**: `src/interfaces/`

**èŒè´£**: å®šä¹‰æ‰€æœ‰æ¨¡å—é—´çš„æ¥å£å’Œæ•°æ®æ¨¡å‹

**æ ¸å¿ƒæ¥å£**:
- `AIEngineInterface`: AI å¼•æ“æ¥å£
- `SecurityEngineInterface`: å®‰å…¨å¼•æ“æ¥å£
- `ExecutorInterface`: æ‰§è¡Œå™¨æ¥å£
- `StorageInterface`: å­˜å‚¨æ¥å£

**æ•°æ®æ¨¡å‹**:
- `Suggestion`: å‘½ä»¤å»ºè®®
- `ValidationResult`: éªŒè¯ç»“æœ
- `ExecutionResult`: æ‰§è¡Œç»“æœ
- `Context`: ä¸Šä¸‹æ–‡ä¿¡æ¯
- `CommandEntry`: å‘½ä»¤å†å²æ¡ç›®
- `Session`: ä¼šè¯ä¿¡æ¯

**è®¾è®¡åŸåˆ™**:
- ä½¿ç”¨æŠ½è±¡åŸºç±»å®šä¹‰æ¥å£
- æ•°æ®ç±»ä½¿ç”¨ `@dataclass` è£…é¥°å™¨
- ç±»å‹æç¤ºç¡®ä¿ç±»å‹å®‰å…¨
- æ¥å£ä¸å®ç°åˆ†ç¦»

---

### 3. AI å¼•æ“ (AI Engine)

**ä½ç½®**: `src/ai_engine/`

**èŒè´£**: å°†ä¸­æ–‡è‡ªç„¶è¯­è¨€è½¬æ¢ä¸º PowerShell å‘½ä»¤

**ç»„ä»¶**:
- `engine.py`: AI å¼•æ“ä¸»ç±»ï¼Œåè°ƒç¿»è¯‘æµç¨‹
- `translation.py`: ç¿»è¯‘é€»è¾‘å’Œè§„åˆ™åŒ¹é…
- `providers.py`: AI æä¾›å•†ï¼ˆLLaMAã€Ollama ç­‰ï¼‰
- `error_detection.py`: é”™è¯¯æ£€æµ‹å’Œä¿®æ­£

**å·¥ä½œæµç¨‹**:
1. æ¥æ”¶ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€è¾“å…¥
2. æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰åŒ¹é…ç»“æœ
3. å°è¯•è§„åˆ™åŒ¹é…ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰
4. å¦‚æœè§„åˆ™åŒ¹é…å¤±è´¥ï¼Œä½¿ç”¨ AI æ¨¡å‹ç”Ÿæˆ
5. é”™è¯¯æ£€æµ‹å’Œä¿®æ­£
6. ç¼“å­˜ç»“æœå¹¶è¿”å›

**ç‰¹ç‚¹**:
- è§„åˆ™åŒ¹é…å’Œ AI æ¨¡å‹ç»“åˆ
- æ”¯æŒå¤šç§ AI æä¾›å•†
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥
- ç½®ä¿¡åº¦è¯„åˆ†
- ç¼“å­˜æœºåˆ¶

**æ”¯æŒçš„ AI æä¾›å•†**:
- Local: æœ¬åœ° LLaMA æ¨¡å‹
- Ollama: Ollama æœåŠ¡
- OpenAI: OpenAI API
- Azure: Azure OpenAI

---

### 4. å®‰å…¨å¼•æ“ (Security Engine)

**ä½ç½®**: `src/security/`

**èŒè´£**: ä¸‰å±‚å®‰å…¨éªŒè¯å’Œæ²™ç®±æ‰§è¡Œ

**ç»„ä»¶**:
- `engine.py`: å®‰å…¨å¼•æ“ä¸»ç±»ï¼Œåè°ƒä¸‰å±‚éªŒè¯
- `whitelist.py`: å‘½ä»¤ç™½åå•éªŒè¯
- `permissions.py`: æƒé™æ£€æŸ¥å’Œç¡®è®¤
- `sandbox.py`: Docker æ²™ç®±æ‰§è¡Œ

**ä¸‰å±‚å®‰å…¨æ¶æ„**:

```
ç¬¬ä¸€å±‚ï¼šå‘½ä»¤ç™½åå•éªŒè¯
  â”œâ”€ æ£€æŸ¥å±é™©å‘½ä»¤æ¨¡å¼ï¼ˆ30+ ç§ï¼‰
  â”œâ”€ è¯†åˆ«å®‰å…¨å‘½ä»¤å‰ç¼€
  â””â”€ é£é™©ç­‰çº§è¯„ä¼°
         â”‚
         â–¼
ç¬¬äºŒå±‚ï¼šæƒé™æ£€æŸ¥
  â”œâ”€ æ£€æµ‹ç®¡ç†å‘˜æƒé™éœ€æ±‚
  â”œâ”€ ç”¨æˆ·ç¡®è®¤æµç¨‹
  â””â”€ æƒé™æå‡æ—¥å¿—
         â”‚
         â–¼
ç¬¬ä¸‰å±‚ï¼šæ²™ç®±æ‰§è¡Œï¼ˆå¯é€‰ï¼‰
  â”œâ”€ Docker å®¹å™¨éš”ç¦»
  â”œâ”€ èµ„æºé™åˆ¶
  â””â”€ ç½‘ç»œéš”ç¦»
```

**é£é™©ç­‰çº§**:
- `SAFE`: å®‰å…¨å‘½ä»¤ï¼ˆGet-*, Show-*, Test-* ç­‰ï¼‰
- `LOW`: ä½é£é™©å‘½ä»¤
- `MEDIUM`: ä¸­ç­‰é£é™©ï¼ˆéœ€è¦ç¡®è®¤ï¼‰
- `HIGH`: é«˜é£é™©ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™æˆ–ç‰¹åˆ«å±é™©ï¼‰
- `CRITICAL`: ä¸¥é‡é£é™©ï¼ˆå¯èƒ½é€ æˆç³»ç»ŸæŸåï¼‰

**å±é™©å‘½ä»¤ç±»åˆ«**:
- æ–‡ä»¶ç³»ç»Ÿå±é™©æ“ä½œï¼ˆé€’å½’åˆ é™¤ã€æ ¼å¼åŒ–ç£ç›˜ç­‰ï¼‰
- ç³»ç»Ÿæ§åˆ¶ï¼ˆå…³æœºã€é‡å¯ç­‰ï¼‰
- æ³¨å†Œè¡¨æ“ä½œ
- ç½‘ç»œå’Œé˜²ç«å¢™é…ç½®
- è¿›ç¨‹å’Œä»»åŠ¡ç®¡ç†
- ç”¨æˆ·å’Œæƒé™ç®¡ç†
- è„šæœ¬æ‰§è¡Œç­–ç•¥
- è¿œç¨‹ä»£ç ä¸‹è½½å’Œæ‰§è¡Œ

**æ²™ç®±ç‰¹æ€§**:
- å†…å­˜é™åˆ¶: é»˜è®¤ 512MB
- CPU é™åˆ¶: é»˜è®¤ 0.5 æ ¸å¿ƒ
- ç½‘ç»œéš”ç¦»: å¯é€‰ç¦ç”¨ç½‘ç»œ
- åªè¯»æ–‡ä»¶ç³»ç»Ÿ: é˜²æ­¢æ–‡ä»¶ä¿®æ”¹
- è¿›ç¨‹æ•°é™åˆ¶: æœ€å¤š 100 ä¸ªè¿›ç¨‹
- å®‰å…¨é€‰é¡¹: `no-new-privileges`

**ç‰¹ç‚¹**:
- å¯é…ç½®çš„å®‰å…¨è§„åˆ™
- æ™ºèƒ½é£é™©è¯„ä¼°
- å®Œæ•´å®¡è®¡æ—¥å¿—
- æ²™ç®±éš”ç¦»æ”¯æŒ
- è·¨å¹³å°æƒé™æ£€æŸ¥

---

### 5. æ‰§è¡Œå¼•æ“ (Execution Engine)

**ä½ç½®**: `src/execution/`

**èŒè´£**: è·¨å¹³å° PowerShell å‘½ä»¤æ‰§è¡Œ

**ç»„ä»¶**:
- `executor.py`: æ‰§è¡Œå™¨ä¸»ç±»
- `platform_adapter.py`: å¹³å°é€‚é…å™¨
- `output_formatter.py`: è¾“å‡ºæ ¼å¼åŒ–

**å·¥ä½œæµç¨‹**:
1. æ¥æ”¶å¾…æ‰§è¡Œçš„ PowerShell å‘½ä»¤
2. å¹³å°æ£€æµ‹å’Œé€‚é…
3. æ‰§è¡Œå‘½ä»¤å¹¶æ•è·è¾“å‡º
4. æ ¼å¼åŒ–è¾“å‡ºç»“æœ
5. é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**ç‰¹ç‚¹**:
- è‡ªåŠ¨å¹³å°æ£€æµ‹ï¼ˆWindows/Linux/macOSï¼‰
- PowerShell ç‰ˆæœ¬è‡ªåŠ¨é€‰æ‹©
- ä¸­æ–‡ç¼–ç æ”¯æŒ
- è¶…æ—¶æ§åˆ¶
- è¾“å‡ºæ ¼å¼åŒ–
- è¿”å›ç å¤„ç†

**å¹³å°æ”¯æŒ**:
- Windows: PowerShell 5.1 / PowerShell Core
- Linux: PowerShell Core
- macOS: PowerShell Core

---

### 6. é…ç½®ç®¡ç† (Configuration Management)

**ä½ç½®**: `src/config/`

**èŒè´£**: ç³»ç»Ÿé…ç½®å’ŒéªŒè¯

**ç»„ä»¶**:
- `manager.py`: é…ç½®ç®¡ç†å™¨
- `models.py`: é…ç½®æ•°æ®æ¨¡å‹ï¼ˆä½¿ç”¨ Pydanticï¼‰

**é…ç½®æ¨¡å‹**:

#### AIConfig - AI å¼•æ“é…ç½®
- `provider`: AI æä¾›å•† (local, ollama, openai, azure)
- `model_name`: AI æ¨¡å‹åç§°
- `temperature`: ç”Ÿæˆæ¸©åº¦ (0.0-2.0)
- `max_tokens`: æœ€å¤§ç”Ÿæˆ token æ•° (1-4096)
- `cache_enabled`: æ˜¯å¦å¯ç”¨ç¿»è¯‘ç¼“å­˜
- `cache_size`: ç¼“å­˜å¤§å°

#### SecurityConfig - å®‰å…¨å¼•æ“é…ç½®
- `sandbox_enabled`: æ˜¯å¦å¯ç”¨æ²™ç®±æ‰§è¡Œ
- `require_confirmation`: æ˜¯å¦éœ€è¦ç”¨æˆ·ç¡®è®¤
- `whitelist_mode`: ç™½åå•æ¨¡å¼ (strict, moderate, permissive)
- `dangerous_patterns`: å±é™©å‘½ä»¤æ¨¡å¼åˆ—è¡¨
- `safe_prefixes`: å®‰å…¨å‘½ä»¤å‰ç¼€åˆ—è¡¨
- `custom_rules`: è‡ªå®šä¹‰å®‰å…¨è§„åˆ™

#### ExecutionConfig - æ‰§è¡Œå¼•æ“é…ç½®
- `timeout`: å‘½ä»¤æ‰§è¡Œè¶…æ—¶æ—¶é—´ (1-300 ç§’)
- `encoding`: è¾“å‡ºç¼–ç æ ¼å¼
- `platform`: å¹³å°ç±»å‹ (auto, windows, linux, macos)
- `powershell_path`: PowerShell å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„
- `auto_detect_powershell`: æ˜¯å¦è‡ªåŠ¨æ£€æµ‹ PowerShell

#### LoggingConfig - æ—¥å¿—é…ç½®
- `level`: æ—¥å¿—çº§åˆ« (DEBUG, INFO, WARNING, ERROR, CRITICAL)
- `file`: æ—¥å¿—æ–‡ä»¶è·¯å¾„
- `max_size`: æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°
- `backup_count`: æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°é‡
- `format`: æ—¥å¿—æ ¼å¼
- `console_output`: æ˜¯å¦è¾“å‡ºåˆ°æ§åˆ¶å°

#### StorageConfig - å­˜å‚¨é…ç½®
- `base_path`: å­˜å‚¨åŸºç¡€è·¯å¾„
- `history_file`: å†å²è®°å½•æ–‡ä»¶å
- `config_file`: é…ç½®æ–‡ä»¶å
- `cache_dir`: ç¼“å­˜ç›®å½•å
- `max_history_size`: æœ€å¤§å†å²è®°å½•æ•°é‡

#### ContextConfig - ä¸Šä¸‹æ–‡ç®¡ç†é…ç½®
- `max_context_depth`: æœ€å¤§ä¸Šä¸‹æ–‡æ·±åº¦ (1-50)
- `session_timeout`: ä¼šè¯è¶…æ—¶æ—¶é—´ (â‰¥60 ç§’)
- `enable_learning`: æ˜¯å¦å¯ç”¨å­¦ä¹ åŠŸèƒ½

**é…ç½®å±‚çº§**:
- é»˜è®¤é…ç½®ï¼ˆ`config/default.yaml`ï¼‰
- ç”¨æˆ·é…ç½®ï¼ˆ`~/.ai-powershell/config.yaml`ï¼‰
- ç¯å¢ƒå˜é‡è¦†ç›–
- å‘½ä»¤è¡Œå‚æ•°è¦†ç›–

**æ ¸å¿ƒæ–¹æ³•**:
- `load_config()`: ä»æ–‡ä»¶åŠ è½½é…ç½®
- `save_config()`: ä¿å­˜é…ç½®åˆ°æ–‡ä»¶
- `update_config()`: æ›´æ–°é…ç½®ï¼ˆæ·±åº¦åˆå¹¶ï¼‰
- `validate_config()`: éªŒè¯é…ç½®æ•°æ®
- `reset_to_defaults()`: é‡ç½®ä¸ºé»˜è®¤é…ç½®

**ç‰¹ç‚¹**:
- YAML é…ç½®æ–‡ä»¶
- Pydantic æ•°æ®éªŒè¯
- é»˜è®¤å€¼æ”¯æŒ
- é…ç½®çƒ­é‡è½½
- ç±»å‹å®‰å…¨

---

### 7. æ—¥å¿—å¼•æ“ (Logging Engine)

**ä½ç½®**: `src/log_engine/`

**èŒè´£**: å…¨é¢çš„å®¡è®¡è·Ÿè¸ªå’Œæ€§èƒ½ç›‘æ§

**ç»„ä»¶**:
- `engine.py`: æ—¥å¿—å¼•æ“ä¸»ç±»
- `decorators.py`: æ—¥å¿—è£…é¥°å™¨
- `filters.py`: æ—¥å¿—è¿‡æ»¤å™¨

**æ—¥å¿—ç±»å‹**:
- ç”¨æˆ·è¯·æ±‚æ—¥å¿—
- AI ç¿»è¯‘æ—¥å¿—
- å®‰å…¨éªŒè¯æ—¥å¿—
- å‘½ä»¤æ‰§è¡Œæ—¥å¿—
- æ€§èƒ½ç›‘æ§æ—¥å¿—

**ç‰¹ç‚¹**:
- ç»“æ„åŒ–æ—¥å¿—ï¼ˆJSON æ ¼å¼ï¼‰
- å…³è”è¿½è¸ªï¼ˆCorrelation IDï¼‰
- æ•æ„Ÿä¿¡æ¯è¿‡æ»¤
- å¤šç§è¾“å‡ºç›®æ ‡
- æ—¥å¿—è½®è½¬
- æ€§èƒ½ç›‘æ§

**æ—¥å¿—çº§åˆ«**:
- DEBUG: è¯¦ç»†è°ƒè¯•ä¿¡æ¯
- INFO: ä¸€èˆ¬ä¿¡æ¯
- WARNING: è­¦å‘Šä¿¡æ¯
- ERROR: é”™è¯¯ä¿¡æ¯
- CRITICAL: ä¸¥é‡é”™è¯¯

---

### 8. å­˜å‚¨å¼•æ“ (Storage Engine)

**ä½ç½®**: `src/storage/`

**èŒè´£**: æ•°æ®æŒä¹…åŒ–å’Œå†å²è®°å½•ç®¡ç†

**ç»„ä»¶**:
- `interfaces.py`: å­˜å‚¨æ¥å£å®šä¹‰
- `file_storage.py`: æ–‡ä»¶å­˜å‚¨å®ç°
- `factory.py`: å­˜å‚¨å·¥å‚

**å­˜å‚¨æ¥å£æ–¹æ³•**:
- `save_history()` / `load_history()`: å†å²è®°å½•ç®¡ç†
- `save_config()` / `load_config()`: é…ç½®ç®¡ç†
- `save_cache()` / `load_cache()`: ç¼“å­˜ç®¡ç†ï¼ˆæ”¯æŒ TTLï¼‰
- `save_session()` / `load_session()`: ä¼šè¯ç®¡ç†
- `save_snapshot()` / `load_snapshot()`: å¿«ç…§ç®¡ç†
- `save_user_preferences()` / `load_user_preferences()`: ç”¨æˆ·åå¥½
- `get_storage_info()`: è·å–å­˜å‚¨ä¿¡æ¯

**æ–‡ä»¶å­˜å‚¨ç»“æ„**:
```
~/.ai-powershell/
â”œâ”€â”€ sessions/           # ä¼šè¯æ•°æ®
â”‚   â”œâ”€â”€ {session_id}.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ snapshots/          # ä¸Šä¸‹æ–‡å¿«ç…§
â”‚   â”œâ”€â”€ {snapshot_id}.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ preferences/        # ç”¨æˆ·åå¥½
â”‚   â”œâ”€â”€ {user_id}.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ history.json        # å‘½ä»¤å†å²
â”œâ”€â”€ config.yaml         # é…ç½®æ–‡ä»¶
â””â”€â”€ cache/             # ç¼“å­˜æ•°æ®
    â”œâ”€â”€ key1.json
    â””â”€â”€ key2.json
```

**ç‰¹ç‚¹**:
- ä½¿ç”¨ JSON æ ¼å¼å­˜å‚¨å†å²è®°å½•
- ä½¿ç”¨ YAML æ ¼å¼å­˜å‚¨é…ç½®
- æ”¯æŒç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆTTLï¼‰
- è‡ªåŠ¨åˆ›å»ºå¿…è¦çš„ç›®å½•ç»“æ„
- å·¥å‚æ¨¡å¼æ”¯æŒå¤šç§å­˜å‚¨åç«¯

**æ”¯æŒçš„å­˜å‚¨ç±»å‹**:
- `file`: æ–‡ä»¶å­˜å‚¨ï¼ˆå·²å®ç°ï¼‰
- `memory`: å†…å­˜å­˜å‚¨ï¼ˆå¾…å®ç°ï¼‰
- `database`: æ•°æ®åº“å­˜å‚¨ï¼ˆå¾…å®ç°ï¼‰

---

### 9. ä¸Šä¸‹æ–‡ç®¡ç† (Context Management)

**ä½ç½®**: `src/context/`

**èŒè´£**: ä¼šè¯ç®¡ç†ã€å‘½ä»¤å†å²è®°å½•å’Œç”¨æˆ·åå¥½è®¾ç½®

**ç»„ä»¶**:
- `manager.py`: ä¸Šä¸‹æ–‡ç®¡ç†å™¨
- `history.py`: å†å²è®°å½•ç®¡ç†å™¨
- `models.py`: ä¸Šä¸‹æ–‡æ•°æ®æ¨¡å‹

**æ•°æ®æ¨¡å‹**:

#### CommandEntry - å‘½ä»¤å†å²æ¡ç›®
```python
@dataclass
class CommandEntry:
    command_id: str              # å‘½ä»¤å”¯ä¸€æ ‡è¯†
    user_input: str              # ç”¨æˆ·åŸå§‹è¾“å…¥
    translated_command: str      # ç¿»è¯‘åçš„å‘½ä»¤
    status: CommandStatus        # å‘½ä»¤çŠ¶æ€
    output: str                  # å‘½ä»¤è¾“å‡º
    error: str                   # é”™è¯¯ä¿¡æ¯
    return_code: int             # è¿”å›ç 
    execution_time: float        # æ‰§è¡Œæ—¶é—´
    confidence_score: float      # AI ç¿»è¯‘ç½®ä¿¡åº¦
    timestamp: datetime          # æ—¶é—´æˆ³
    metadata: Dict[str, Any]     # é¢å¤–å…ƒæ•°æ®
```

#### Session - ä¼šè¯
```python
@dataclass
class Session:
    session_id: str              # ä¼šè¯å”¯ä¸€æ ‡è¯†
    user_id: Optional[str]       # ç”¨æˆ· ID
    status: SessionStatus        # ä¼šè¯çŠ¶æ€
    start_time: datetime         # ä¼šè¯å¼€å§‹æ—¶é—´
    last_activity: datetime      # æœ€åæ´»åŠ¨æ—¶é—´
    end_time: Optional[datetime] # ä¼šè¯ç»“æŸæ—¶é—´
    working_directory: str       # å·¥ä½œç›®å½•
    environment_vars: Dict       # ç¯å¢ƒå˜é‡
    command_history: List[CommandEntry]  # å‘½ä»¤å†å²
    metadata: Dict[str, Any]     # é¢å¤–å…ƒæ•°æ®
```

**ContextManager æ ¸å¿ƒåŠŸèƒ½**:
- ä¼šè¯ç®¡ç†ï¼ˆå¼€å§‹ã€åˆ‡æ¢ã€ç»ˆæ­¢ï¼‰
- å‘½ä»¤ç®¡ç†ï¼ˆæ·»åŠ ã€æ›´æ–°ã€æŸ¥è¯¢ï¼‰
- ä¸Šä¸‹æ–‡æŸ¥è¯¢
- å¿«ç…§ç®¡ç†
- ç”¨æˆ·åå¥½ç®¡ç†
- ç»Ÿè®¡ä¿¡æ¯

**HistoryManager æ ¸å¿ƒåŠŸèƒ½**:
- åŸºç¡€æ“ä½œï¼ˆæ·»åŠ ã€åˆ é™¤ã€æ¸…ç©ºï¼‰
- æœç´¢å’Œè¿‡æ»¤
- ç»Ÿè®¡åˆ†æ
- å¯¼å‡ºå’Œå¯¼å…¥ï¼ˆJSON/CSVï¼‰

**ç‰¹ç‚¹**:
- ä¼šè¯ç¼“å­˜ï¼Œé¿å…é¢‘ç¹ç£ç›˜ I/O
- å¯é…ç½®çš„å†å²è®°å½•æ•°é‡ä¸Šé™
- æ”¯æŒæ‰¹é‡ä¿å­˜
- å»¶è¿ŸåŠ è½½
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸä¼šè¯

---

## æ•°æ®æµ

### å®Œæ•´è¯·æ±‚å¤„ç†æµç¨‹

```
ç”¨æˆ·è¾“å…¥
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸»æ§åˆ¶å™¨æ¥æ”¶è¯·æ±‚    â”‚
â”‚  PowerShellAssistant â”‚
â”‚  - ç”Ÿæˆå…³è” ID       â”‚
â”‚  - è®°å½•è¯·æ±‚æ—¥å¿—      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ„å»ºä¸Šä¸‹æ–‡          â”‚
â”‚  - è·å–å½“å‰ä¼šè¯      â”‚
â”‚  - è·å–å‘½ä»¤å†å²      â”‚
â”‚  - è·å–å·¥ä½œç›®å½•      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI å¼•æ“ç¿»è¯‘        â”‚
â”‚  - æ£€æŸ¥ç¼“å­˜          â”‚
â”‚  - è§„åˆ™åŒ¹é…          â”‚
â”‚  - AI æ¨¡å‹ç”Ÿæˆ       â”‚
â”‚  - é”™è¯¯æ£€æµ‹          â”‚
â”‚  - ç½®ä¿¡åº¦è¯„åˆ†        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®‰å…¨å¼•æ“éªŒè¯        â”‚
â”‚  ç¬¬ä¸€å±‚ï¼šç™½åå•æ£€æŸ¥  â”‚
â”‚  - å±é™©å‘½ä»¤æ£€æµ‹      â”‚
â”‚  - é£é™©ç­‰çº§è¯„ä¼°      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬äºŒå±‚ï¼šæƒé™æ£€æŸ¥    â”‚
â”‚  - ç®¡ç†å‘˜æƒé™æ£€æµ‹    â”‚
â”‚  - æƒé™æå‡æ—¥å¿—      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸‰å±‚ï¼šæ²™ç®±æ‰§è¡Œ    â”‚
â”‚  ï¼ˆå¯é€‰ï¼‰            â”‚
â”‚  - Docker å®¹å™¨éš”ç¦»   â”‚
â”‚  - èµ„æºé™åˆ¶          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç¡®è®¤            â”‚
â”‚  - æ˜¾ç¤ºç”Ÿæˆçš„å‘½ä»¤    â”‚
â”‚  - æ˜¾ç¤ºé£é™©ä¿¡æ¯      â”‚
â”‚  - ç­‰å¾…ç”¨æˆ·ç¡®è®¤      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰§è¡Œå¼•æ“æ‰§è¡Œ        â”‚
â”‚  - å¹³å°é€‚é…          â”‚
â”‚  - å‘½ä»¤æ‰§è¡Œ          â”‚
â”‚  - è¾“å‡ºæ•è·          â”‚
â”‚  - é”™è¯¯å¤„ç†          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»“æœå¤„ç†            â”‚
â”‚  - è¾“å‡ºæ ¼å¼åŒ–        â”‚
â”‚  - æ—¥å¿—è®°å½•          â”‚
â”‚  - å†å²ä¿å­˜          â”‚
â”‚  - ä¸Šä¸‹æ–‡æ›´æ–°        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
è¿”å›ç»“æœç»™ç”¨æˆ·
```

### æ¨¡å—é—´æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Context      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸»æ§åˆ¶å™¨      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ ä¸Šä¸‹æ–‡ç®¡ç†å™¨  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ è‡ªç„¶è¯­è¨€ + Context
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Cache        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI å¼•æ“      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  å­˜å‚¨å¼•æ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Suggestion
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Rules        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®‰å…¨å¼•æ“     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  é…ç½®ç®¡ç†     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ ValidationResult
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Logs         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰§è¡Œå¼•æ“     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  æ—¥å¿—å¼•æ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ ExecutionResult
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     History      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸»æ§åˆ¶å™¨      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ å†å²ç®¡ç†å™¨    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## è®¾è®¡æ¨¡å¼

### 1. ä¾èµ–æ³¨å…¥ (Dependency Injection)

æ‰€æœ‰æ¨¡å—é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ä¾èµ–ï¼Œé™ä½è€¦åˆåº¦ï¼š

```python
class PowerShellAssistant:
    def __init__(self, config_path: Optional[str] = None):
        # æ³¨å…¥é…ç½®ç®¡ç†å™¨
        self.config_manager = ConfigManager(config_path)
        
        # æ³¨å…¥æ—¥å¿—å¼•æ“
        self.log_engine = LogEngine(self.config.logging)
        
        # æ³¨å…¥å­˜å‚¨å¼•æ“
        self.storage = StorageFactory.create_storage(...)
        
        # æ³¨å…¥å…¶ä»–ä¾èµ–
        self.context_manager = ContextManager(storage=self.storage)
        self.ai_engine = AIEngine(self.config.ai.model_dump())
        self.security_engine = SecurityEngine(self.config.security.model_dump())
        self.executor = CommandExecutor(self.config.execution.model_dump())
```

**ä¼˜ç‚¹**:
- ä¾¿äºå•å…ƒæµ‹è¯•ï¼ˆå¯æ³¨å…¥ Mock å¯¹è±¡ï¼‰
- æé«˜ä»£ç å¯ç»´æŠ¤æ€§
- é™ä½æ¨¡å—é—´è€¦åˆ

### 2. å·¥å‚æ¨¡å¼ (Factory Pattern)

å­˜å‚¨å¼•æ“ä½¿ç”¨å·¥å‚æ¨¡å¼åˆ›å»ºå®ä¾‹ï¼š

```python
class StorageFactory:
    @staticmethod
    def create_storage(storage_type: str = "file", config: Dict = None) -> StorageInterface:
        if storage_type == "file":
            return FileStorage(config)
        elif storage_type == "memory":
            return MemoryStorage(config)
        elif storage_type == "database":
            return DatabaseStorage(config)
        else:
            raise ValueError(f"Unknown storage type: {storage_type}")
    
    @staticmethod
    def get_default_storage() -> StorageInterface:
        return StorageFactory.create_storage("file")
```

**ä¼˜ç‚¹**:
- ç»Ÿä¸€çš„åˆ›å»ºæ¥å£
- æ”¯æŒå¤šç§å­˜å‚¨åç«¯
- å®ä¾‹ç¼“å­˜æœºåˆ¶
- ä¾¿äºæ‰©å±•

### 3. ç­–ç•¥æ¨¡å¼ (Strategy Pattern)

AI å¼•æ“æ”¯æŒå¤šç§ AI æä¾›å•†ï¼š

```python
class AIEngine:
    def __init__(self, config: Dict):
        self.provider = self._create_provider(config['provider'])
    
    def _create_provider(self, provider_type: str) -> AIProvider:
        if provider_type == "local":
            return LocalProvider()
        elif provider_type == "ollama":
            return OllamaProvider()
        elif provider_type == "openai":
            return OpenAIProvider()
        # ...
```

**ä¼˜ç‚¹**:
- çµæ´»åˆ‡æ¢ AI æä¾›å•†
- æ˜“äºæ·»åŠ æ–°çš„æä¾›å•†
- è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©

### 4. è£…é¥°å™¨æ¨¡å¼ (Decorator Pattern)

æ—¥å¿—å¼•æ“æä¾›è£…é¥°å™¨ç”¨äºæ–¹æ³•æ—¥å¿—è®°å½•ï¼š

```python
@log_execution
def process_request(self, user_input: str) -> ExecutionResult:
    # æ–¹æ³•å®ç°
    pass
```

**ä¼˜ç‚¹**:
- éä¾µå…¥å¼æ—¥å¿—è®°å½•
- ä»£ç å¤ç”¨
- å…³æ³¨ç‚¹åˆ†ç¦»

### 5. å•ä¾‹æ¨¡å¼ (Singleton Pattern)

é…ç½®ç®¡ç†å™¨å’Œæ—¥å¿—å¼•æ“ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼š

```python
class ConfigManager:
    _instance = None
    
    def __new__(cls, *args, **kwargs):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance
```

**ä¼˜ç‚¹**:
- å…¨å±€å”¯ä¸€å®ä¾‹
- é¿å…é‡å¤åˆå§‹åŒ–
- èŠ‚çœèµ„æº

### 6. è§‚å¯Ÿè€…æ¨¡å¼ (Observer Pattern)

ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ”¯æŒäº‹ä»¶ç›‘å¬ï¼š

```python
class ContextManager:
    def __init__(self):
        self._listeners = []
    
    def add_listener(self, listener):
        self._listeners.append(listener)
    
    def _notify_listeners(self, event):
        for listener in self._listeners:
            listener.on_event(event)
```

**ä¼˜ç‚¹**:
- è§£è€¦äº‹ä»¶æºå’Œäº‹ä»¶å¤„ç†
- æ”¯æŒå¤šä¸ªç›‘å¬å™¨
- æ˜“äºæ‰©å±•

### 7. æ¨¡æ¿æ–¹æ³•æ¨¡å¼ (Template Method Pattern)

å®‰å…¨å¼•æ“çš„ä¸‰å±‚éªŒè¯æµç¨‹ï¼š

```python
class SecurityEngine:
    def validate_command(self, command: str, context: Context) -> ValidationResult:
        # æ¨¡æ¿æ–¹æ³•å®šä¹‰éªŒè¯æµç¨‹
        result = self._layer1_whitelist_check(command)
        if not result.is_valid:
            return result
        
        result = self._layer2_permission_check(command)
        if not result.is_valid:
            return result
        
        result = self._layer3_sandbox_check(command)
        return result
```

**ä¼˜ç‚¹**:
- å®šä¹‰ç®—æ³•éª¨æ¶
- å­æ­¥éª¤å¯çµæ´»å®ç°
- ä¿è¯æµç¨‹ä¸€è‡´æ€§

---

## æ‰©å±•ç‚¹

ç³»ç»Ÿè®¾è®¡äº†å¤šä¸ªæ‰©å±•ç‚¹ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•å’Œå®šåˆ¶ï¼š

### 1. æ·»åŠ æ–°çš„ AI æä¾›å•†

ç»§æ‰¿ `AIProvider` æŠ½è±¡åŸºç±»å¹¶å®ç°æ¥å£ï¼š

```python
from src.ai_engine.providers import AIProvider

class CustomAIProvider(AIProvider):
    def generate(self, prompt: str, context: Context) -> str:
        # å®ç°è‡ªå®šä¹‰ AI ç”Ÿæˆé€»è¾‘
        pass
    
    def is_available(self) -> bool:
        # æ£€æŸ¥æä¾›å•†æ˜¯å¦å¯ç”¨
        pass
```

åœ¨é…ç½®ä¸­æ³¨å†Œï¼š
```yaml
ai:
  provider: custom
  model_name: my-model
```

### 2. æ·»åŠ æ–°çš„å­˜å‚¨åç«¯

å®ç° `StorageInterface` æ¥å£ï¼š

```python
from src.storage.interfaces import StorageInterface

class DatabaseStorage(StorageInterface):
    def save_history(self, entry: Dict[str, Any]) -> bool:
        # å®ç°æ•°æ®åº“å­˜å‚¨é€»è¾‘
        pass
    
    def load_history(self, limit: int = 100) -> List[Dict[str, Any]]:
        # å®ç°æ•°æ®åº“åŠ è½½é€»è¾‘
        pass
    
    # å®ç°å…¶ä»–æ¥å£æ–¹æ³•...
```

åœ¨ `StorageFactory` ä¸­æ³¨å†Œï¼š
```python
class StorageFactory:
    @staticmethod
    def create_storage(storage_type: str, config: Dict = None):
        if storage_type == "database":
            return DatabaseStorage(config)
        # ...
```

### 3. æ·»åŠ è‡ªå®šä¹‰å®‰å…¨è§„åˆ™

ç¼–è¾‘é…ç½®æ–‡ä»¶æ·»åŠ å±é™©æ¨¡å¼ï¼š

```yaml
security:
  dangerous_patterns:
    - pattern: "My-DangerousCommand"
      description: "è‡ªå®šä¹‰å±é™©å‘½ä»¤"
      risk_level: HIGH
```

æˆ–é€šè¿‡ä»£ç æ·»åŠ ï¼š
```python
from src.security import CommandWhitelist
from src.interfaces.base import RiskLevel

whitelist = CommandWhitelist()
whitelist.add_custom_rule(
    r"My-DangerousCommand",
    "è‡ªå®šä¹‰å±é™©å‘½ä»¤",
    RiskLevel.HIGH
)
```

### 4. æ·»åŠ ç¿»è¯‘è§„åˆ™

åœ¨ `src/ai_engine/translation.py` ä¸­æ·»åŠ è§„åˆ™ï¼š

```python
def _load_rules(self):
    self.rules = [
        # ç°æœ‰è§„åˆ™...
        {
            'pattern': r'æ˜¾ç¤º(.+)',
            'template': 'Get-{0}',
            'confidence': 0.9
        },
        # æ·»åŠ æ–°è§„åˆ™
        {
            'pattern': r'æˆ‘çš„è‡ªå®šä¹‰è§„åˆ™',
            'template': 'My-CustomCommand',
            'confidence': 0.95
        }
    ]
```

### 5. æ·»åŠ è‡ªå®šä¹‰æ—¥å¿—è¿‡æ»¤å™¨

å®ç°æ—¥å¿—è¿‡æ»¤å™¨ï¼š

```python
from src.log_engine.filters import LogFilter

class CustomLogFilter(LogFilter):
    def filter(self, record):
        # å®ç°è‡ªå®šä¹‰è¿‡æ»¤é€»è¾‘
        return True  # è¿”å› True è¡¨ç¤ºä¿ç•™æ—¥å¿—
```

æ³¨å†Œè¿‡æ»¤å™¨ï¼š
```python
log_engine.add_filter(CustomLogFilter())
```

### 6. æ·»åŠ å‘½ä»¤æ‰§è¡Œé’©å­

åœ¨æ‰§è¡Œå‰åæ·»åŠ è‡ªå®šä¹‰é€»è¾‘ï¼š

```python
class CustomExecutor(CommandExecutor):
    def execute(self, command: str, **kwargs) -> ExecutionResult:
        # æ‰§è¡Œå‰é’©å­
        self._before_execute(command)
        
        # æ‰§è¡Œå‘½ä»¤
        result = super().execute(command, **kwargs)
        
        # æ‰§è¡Œåé’©å­
        self._after_execute(command, result)
        
        return result
    
    def _before_execute(self, command: str):
        # è‡ªå®šä¹‰å‰ç½®é€»è¾‘
        pass
    
    def _after_execute(self, command: str, result: ExecutionResult):
        # è‡ªå®šä¹‰åç½®é€»è¾‘
        pass
```

### 7. æ·»åŠ ä¸Šä¸‹æ–‡äº‹ä»¶ç›‘å¬å™¨

ç›‘å¬ä¼šè¯å’Œå‘½ä»¤äº‹ä»¶ï¼š

```python
class CustomContextListener:
    def on_session_start(self, session: Session):
        # ä¼šè¯å¼€å§‹æ—¶çš„é€»è¾‘
        pass
    
    def on_session_end(self, session: Session):
        # ä¼šè¯ç»“æŸæ—¶çš„é€»è¾‘
        pass
    
    def on_command_added(self, entry: CommandEntry):
        # å‘½ä»¤æ·»åŠ æ—¶çš„é€»è¾‘
        pass

# æ³¨å†Œç›‘å¬å™¨
context_manager.add_listener(CustomContextListener())
```

### 8. è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼åŒ–

å®ç°è‡ªå®šä¹‰è¾“å‡ºæ ¼å¼åŒ–å™¨ï¼š

```python
from src.execution.output_formatter import OutputFormatter

class CustomOutputFormatter(OutputFormatter):
    def format(self, output: str, format_type: str = "text") -> str:
        # å®ç°è‡ªå®šä¹‰æ ¼å¼åŒ–é€»è¾‘
        if format_type == "json":
            return self._format_as_json(output)
        elif format_type == "html":
            return self._format_as_html(output)
        return output
```

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.8+ | ä¸»è¦ç¼–ç¨‹è¯­è¨€ |
| PowerShell | 5.1+ / Core 7.0+ | å‘½ä»¤æ‰§è¡Œç¯å¢ƒ |
| PyYAML | 6.0.1+ | é…ç½®æ–‡ä»¶è§£æ |
| Pydantic | 2.0+ | æ•°æ®éªŒè¯å’Œé…ç½®æ¨¡å‹ |
| structlog | 23.1.0+ | ç»“æ„åŒ–æ—¥å¿— |

### AI æ¨¡å‹æ”¯æŒ

| æ¨¡å‹ | æä¾›å•† | ç”¨é€” |
|------|--------|------|
| LLaMA | Meta | æœ¬åœ° AI æ¨ç† |
| Ollama | Ollama | æœ¬åœ°æ¨¡å‹è¿è¡Œ |
| llama-cpp-python | - | Python ç»‘å®š |
| OpenAI GPT | OpenAI | äº‘ç«¯ AI æœåŠ¡ |
| Azure OpenAI | Microsoft | ä¼ä¸šçº§ AI æœåŠ¡ |

### å®‰å…¨å’Œéš”ç¦»

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Docker | 20.10+ | æ²™ç®±æ‰§è¡Œç¯å¢ƒ |
| docker-py | 6.1.0+ | Docker Python SDK |

### å¼€å‘å’Œæµ‹è¯•

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| pytest | 7.0+ | å•å…ƒæµ‹è¯•æ¡†æ¶ |
| pytest-cov | 4.0+ | æµ‹è¯•è¦†ç›–ç‡ |
| black | 23.0+ | ä»£ç æ ¼å¼åŒ– |
| flake8 | 6.0+ | ä»£ç æ£€æŸ¥ |
| mypy | 1.0+ | ç±»å‹æ£€æŸ¥ |

### ä¾èµ–ç®¡ç†

```python
# requirements.txt
pyyaml>=6.0.1
pydantic>=2.0.0
structlog>=23.1.0
docker>=6.1.0
llama-cpp-python>=0.2.0  # å¯é€‰

# requirements-dev.txt
pytest>=7.0.0
pytest-cov>=4.0.0
black>=23.0.0
flake8>=6.0.0
mypy>=1.0.0
```

---

## æ€§èƒ½ä¼˜åŒ–

### 1. ç¼“å­˜ç­–ç•¥

**AI ç¿»è¯‘ç»“æœç¼“å­˜**:
- ä½¿ç”¨ LRU ç¼“å­˜å­˜å‚¨ç¿»è¯‘ç»“æœ
- é»˜è®¤ç¼“å­˜å¤§å°: 1000 æ¡
- ç¼“å­˜å‘½ä¸­ç‡: é€šå¸¸ > 60%

```python
from functools import lru_cache

@lru_cache(maxsize=1000)
def translate_cached(user_input: str) -> str:
    return self.ai_engine.translate(user_input)
```

**é…ç½®æ–‡ä»¶ç¼“å­˜**:
- é…ç½®åŠ è½½åç¼“å­˜åœ¨å†…å­˜
- é¿å…é‡å¤è¯»å–æ–‡ä»¶
- æ”¯æŒé…ç½®çƒ­é‡è½½

**å‘½ä»¤å†å²ç¼“å­˜**:
- æœ€è¿‘å‘½ä»¤ä¿å­˜åœ¨å†…å­˜
- å‡å°‘ç£ç›˜ I/O
- å®šæœŸæ‰¹é‡å†™å…¥ç£ç›˜

### 2. å¼‚æ­¥å¤„ç†

**æ—¥å¿—å¼‚æ­¥å†™å…¥**:
```python
import asyncio

async def log_async(message: str):
    await asyncio.to_thread(self._write_log, message)
```

**ç¼“å­˜å¼‚æ­¥æ›´æ–°**:
```python
async def update_cache_async(key: str, value: Any):
    await asyncio.to_thread(self.storage.save_cache, key, value)
```

### 3. èµ„æºç®¡ç†

**è¿æ¥æ± ç®¡ç†**:
- AI æ¨¡å‹è¿æ¥æ± 
- æ•°æ®åº“è¿æ¥æ± ï¼ˆå¦‚ä½¿ç”¨æ•°æ®åº“å­˜å‚¨ï¼‰
- Docker å®¢æˆ·ç«¯å¤ç”¨

**å†…å­˜é™åˆ¶**:
- å†å²è®°å½•æ•°é‡é™åˆ¶
- ç¼“å­˜å¤§å°é™åˆ¶
- ä¼šè¯è¶…æ—¶è‡ªåŠ¨æ¸…ç†

**è¶…æ—¶æ§åˆ¶**:
- å‘½ä»¤æ‰§è¡Œè¶…æ—¶: é»˜è®¤ 30 ç§’
- AI ç”Ÿæˆè¶…æ—¶: é»˜è®¤ 10 ç§’
- ç½‘ç»œè¯·æ±‚è¶…æ—¶: é»˜è®¤ 5 ç§’

### 4. æ€§èƒ½æŒ‡æ ‡

| æ“ä½œ | ç›®æ ‡æ€§èƒ½ | å®é™…æ€§èƒ½ |
|------|---------|---------|
| é…ç½®åŠ è½½ | < 100ms | ~50ms |
| è§„åˆ™åŒ¹é… | < 10ms | ~5ms |
| AI ç¿»è¯‘ï¼ˆç¼“å­˜å‘½ä¸­ï¼‰ | < 1ms | ~0.5ms |
| AI ç¿»è¯‘ï¼ˆç¼“å­˜æœªå‘½ä¸­ï¼‰ | < 2s | ~1.5s |
| ç™½åå•éªŒè¯ | < 1ms | ~0.5ms |
| æƒé™æ£€æŸ¥ | < 5ms | ~3ms |
| å‘½ä»¤æ‰§è¡Œ | < 30s | å–å†³äºå‘½ä»¤ |
| å†å²è®°å½•ä¿å­˜ | < 10ms | ~5ms |

### 5. ä¼˜åŒ–å»ºè®®

**å¯¹äºé«˜é¢‘ä½¿ç”¨åœºæ™¯**:
- å¯ç”¨ AI ç¿»è¯‘ç¼“å­˜
- ä½¿ç”¨è§„åˆ™åŒ¹é…ä¼˜å…ˆ
- å‡å°‘æ—¥å¿—è¯¦ç»†ç¨‹åº¦

**å¯¹äºèµ„æºå—é™ç¯å¢ƒ**:
- é™åˆ¶å†å²è®°å½•æ•°é‡
- å‡å°ç¼“å­˜å¤§å°
- ç¦ç”¨æ²™ç®±æ‰§è¡Œ

**å¯¹äºä¼ä¸šéƒ¨ç½²**:
- ä½¿ç”¨æ•°æ®åº“å­˜å‚¨
- å¯ç”¨åˆ†å¸ƒå¼ç¼“å­˜
- é…ç½®è´Ÿè½½å‡è¡¡

---

## å®‰å…¨è€ƒè™‘

### 1. è¾“å…¥éªŒè¯

**ç”¨æˆ·è¾“å…¥æ¸…ç†**:
```python
def sanitize_input(user_input: str) -> str:
    # ç§»é™¤å±é™©å­—ç¬¦
    sanitized = re.sub(r'[;&|`$]', '', user_input)
    # é™åˆ¶é•¿åº¦
    return sanitized[:1000]
```

**å‘½ä»¤å‚æ•°éªŒè¯**:
- æ£€æŸ¥å‚æ•°ç±»å‹
- éªŒè¯å‚æ•°èŒƒå›´
- é˜²æ­¢æ³¨å…¥æ”»å‡»

**SQL æ³¨å…¥é˜²æŠ¤**:
- ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
- è¾“å…¥è½¬ä¹‰
- ORM æ¡†æ¶ä¿æŠ¤

### 2. æƒé™æ§åˆ¶

**æœ€å°æƒé™åŸåˆ™**:
- é»˜è®¤ä»¥æ™®é€šç”¨æˆ·æƒé™è¿è¡Œ
- ä»…åœ¨å¿…è¦æ—¶è¯·æ±‚ç®¡ç†å‘˜æƒé™
- æƒé™æå‡éœ€è¦ç”¨æˆ·æ˜ç¡®ç¡®è®¤

**æƒé™æå‡å®¡è®¡**:
```python
def log_privilege_escalation(command: str, user: str):
    self.log_engine.warning(
        f"Privilege escalation requested",
        command=command,
        user=user,
        timestamp=datetime.now()
    )
```

**ç”¨æˆ·ç¡®è®¤æœºåˆ¶**:
- é«˜é£é™©å‘½ä»¤éœ€è¦ç”¨æˆ·ç¡®è®¤
- æ˜¾ç¤ºå‘½ä»¤è¯¦æƒ…å’Œé£é™©ä¿¡æ¯
- æ”¯æŒè‡ªåŠ¨æ‰§è¡Œæ¨¡å¼ï¼ˆéœ€æ˜¾å¼å¯ç”¨ï¼‰

### 3. æ•°æ®ä¿æŠ¤

**æ•æ„Ÿä¿¡æ¯è¿‡æ»¤**:
```python
class SensitiveDataFilter:
    PATTERNS = [
        r'\b\d{16}\b',  # ä¿¡ç”¨å¡å·
        r'\b\d{3}-\d{2}-\d{4}\b',  # ç¤¾ä¼šå®‰å…¨å·
        r'password\s*=\s*[^\s]+',  # å¯†ç 
    ]
    
    def filter(self, text: str) -> str:
        for pattern in self.PATTERNS:
            text = re.sub(pattern, '[REDACTED]', text)
        return text
```

**æ—¥å¿—è„±æ•**:
- è‡ªåŠ¨æ£€æµ‹å’Œè¿‡æ»¤æ•æ„Ÿä¿¡æ¯
- å¯†ç å’Œå¯†é’¥ä¸è®°å½•åˆ°æ—¥å¿—
- ä¸ªäººèº«ä»½ä¿¡æ¯è„±æ•

**æœ¬åœ°æ•°æ®åŠ å¯†**:
- é…ç½®æ–‡ä»¶åŠ å¯†å­˜å‚¨
- ç¼“å­˜æ•°æ®åŠ å¯†
- å†å²è®°å½•åŠ å¯†ï¼ˆå¯é€‰ï¼‰

### 4. ç½‘ç»œå®‰å…¨

**HTTPS é€šä¿¡**:
- ä¸äº‘ç«¯ AI æœåŠ¡é€šä¿¡ä½¿ç”¨ HTTPS
- è¯ä¹¦éªŒè¯
- TLS 1.2+

**ç½‘ç»œéš”ç¦»**:
- æ²™ç®±æ‰§è¡Œæ—¶å¯ç¦ç”¨ç½‘ç»œ
- é˜²ç«å¢™è§„åˆ™é…ç½®
- å‡ºç«™è¿æ¥é™åˆ¶

### 5. ä»£ç å®‰å…¨

**ä¾èµ–å®‰å…¨**:
- å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- ä½¿ç”¨ `pip-audit` æ£€æŸ¥æ¼æ´
- é”å®šä¾èµ–ç‰ˆæœ¬

**ä»£ç å®¡æŸ¥**:
- æ‰€æœ‰ä»£ç å˜æ›´éœ€è¦å®¡æŸ¥
- è‡ªåŠ¨åŒ–å®‰å…¨æ‰«æ
- é™æ€ä»£ç åˆ†æ

**å®‰å…¨æµ‹è¯•**:
- å±é™©å‘½ä»¤é˜»æ­¢æµ‹è¯•
- æƒé™æ£€æŸ¥æµ‹è¯•
- æ²™ç®±éš”ç¦»æµ‹è¯•
- æ³¨å…¥æ”»å‡»æµ‹è¯•

---

## æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•

**æµ‹è¯•æ¡†æ¶**: pytest

**æµ‹è¯•è¦†ç›–**:
- æ¯ä¸ªæ¨¡å—ç‹¬ç«‹æµ‹è¯•
- ç›®æ ‡è¦†ç›–ç‡ > 80%
- å…³é”®è·¯å¾„ 100% è¦†ç›–

**æµ‹è¯•ç»„ç»‡**:
```
tests/
â”œâ”€â”€ ai_engine/          # AI å¼•æ“æµ‹è¯•
â”œâ”€â”€ security/           # å®‰å…¨å¼•æ“æµ‹è¯•
â”œâ”€â”€ execution/          # æ‰§è¡Œå¼•æ“æµ‹è¯•
â”œâ”€â”€ config/             # é…ç½®ç®¡ç†æµ‹è¯•
â”œâ”€â”€ log_engine/         # æ—¥å¿—å¼•æ“æµ‹è¯•
â”œâ”€â”€ storage/            # å­˜å‚¨å¼•æ“æµ‹è¯•
â”œâ”€â”€ context/            # ä¸Šä¸‹æ–‡ç®¡ç†æµ‹è¯•
â”œâ”€â”€ integration/        # é›†æˆæµ‹è¯•
â””â”€â”€ e2e/               # ç«¯åˆ°ç«¯æµ‹è¯•
```

**æµ‹è¯•ç¤ºä¾‹**:
```python
def test_ai_translation():
    engine = AIEngine(config)
    result = engine.translate_natural_language("æ˜¾ç¤ºæ—¶é—´", context)
    assert result.generated_command == "Get-Date"
    assert result.confidence_score > 0.8

def test_security_validation():
    security = SecurityEngine(config)
    result = security.validate_command("Remove-Item -Recurse", context)
    assert not result.is_valid
    assert result.risk_level == RiskLevel.CRITICAL
```

### 2. é›†æˆæµ‹è¯•

**æµ‹è¯•åœºæ™¯**:
- æ¨¡å—é—´äº¤äº’æµ‹è¯•
- ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•
- é”™è¯¯å¤„ç†æµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•

**é›†æˆæµ‹è¯•ç¤ºä¾‹**:
```python
def test_full_request_flow():
    assistant = PowerShellAssistant()
    result = assistant.process_request("æ˜¾ç¤ºå½“å‰æ—¶é—´", auto_execute=True)
    assert result.success
    assert "Get-Date" in result.command
```

### 3. å®‰å…¨æµ‹è¯•

**æµ‹è¯•å†…å®¹**:
- å±é™©å‘½ä»¤é˜»æ­¢æµ‹è¯•
- æƒé™æ£€æŸ¥æµ‹è¯•
- æ²™ç®±éš”ç¦»æµ‹è¯•
- æ³¨å…¥æ”»å‡»æµ‹è¯•
- æƒé™æå‡æµ‹è¯•

**å®‰å…¨æµ‹è¯•ç¤ºä¾‹**:
```python
def test_dangerous_command_blocked():
    security = SecurityEngine(config)
    dangerous_commands = [
        "Remove-Item -Recurse C:\\",
        "Format-Volume",
        "Stop-Computer -Force"
    ]
    for cmd in dangerous_commands:
        result = security.validate_command(cmd, context)
        assert not result.is_valid
```

### 4. æ€§èƒ½æµ‹è¯•

**æµ‹è¯•æŒ‡æ ‡**:
- å“åº”æ—¶é—´
- ååé‡
- èµ„æºä½¿ç”¨
- å¹¶å‘æ€§èƒ½

**æ€§èƒ½æµ‹è¯•ç¤ºä¾‹**:
```python
def test_translation_performance():
    engine = AIEngine(config)
    start = time.time()
    for _ in range(100):
        engine.translate_natural_language("æ˜¾ç¤ºæ—¶é—´", context)
    duration = time.time() - start
    assert duration < 10  # 100 æ¬¡ç¿»è¯‘åº”åœ¨ 10 ç§’å†…å®Œæˆ
```

### 5. æµ‹è¯•è¦†ç›–ç‡

**å½“å‰è¦†ç›–ç‡**:
- é…ç½®ç®¡ç†: 100%
- å­˜å‚¨å¼•æ“: 83%
- å®‰å…¨å¼•æ“: 90%
- ä¸Šä¸‹æ–‡ç®¡ç†: 100%
- ä¸»æ§åˆ¶å™¨: 95%
- æ€»ä½“è¦†ç›–ç‡: ~90%

**è¦†ç›–ç‡æŠ¥å‘Š**:
```bash
pytest --cov=src --cov-report=html
```

---

## éƒ¨ç½²æ¶æ„

### 1. å•æœºéƒ¨ç½²

**é€‚ç”¨åœºæ™¯**: ä¸ªäººç”¨æˆ·ã€å¼€å‘ç¯å¢ƒ

**éƒ¨ç½²æ–¹å¼**:
```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-repo/ai-powershell.git
cd ai-powershell

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œ
python -m src.main
```

**ç‰¹ç‚¹**:
- å¿«é€Ÿå¯åŠ¨
- ç®€å•é…ç½®
- é€‚åˆä¸ªäººä½¿ç”¨

**æ¶æ„å›¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ç”¨æˆ·ç»ˆç«¯                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  AI PowerShell      â”‚    â”‚
â”‚  â”‚  æ™ºèƒ½åŠ©æ‰‹            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚           â”‚                  â”‚
â”‚           â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  æœ¬åœ° AI æ¨¡å‹        â”‚    â”‚
â”‚  â”‚  (Ollama/LLaMA)     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Docker éƒ¨ç½²

**é€‚ç”¨åœºæ™¯**: å®¹å™¨åŒ–ç¯å¢ƒã€éš”ç¦»éƒ¨ç½²

**Dockerfile**:
```dockerfile
FROM python:3.10-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["python", "-m", "src.main"]
```

**docker-compose.yml**:
```yaml
version: '3.8'

services:
  ai-powershell:
    build: .
    volumes:
      - ./config:/app/config
      - ~/.ai-powershell:/root/.ai-powershell
    environment:
      - AI_PROVIDER=ollama
      - OLLAMA_HOST=http://ollama:11434
    depends_on:
      - ollama
  
  ollama:
    image: ollama/ollama:latest
    ports:
      - "11434:11434"
    volumes:
      - ollama-data:/root/.ollama

volumes:
  ollama-data:
```

**éƒ¨ç½²å‘½ä»¤**:
```bash
docker-compose up -d
```

**ç‰¹ç‚¹**:
- ç¯å¢ƒéš”ç¦»
- æ˜“äºç®¡ç†
- å¯ç§»æ¤æ€§å¼º

### 3. Kubernetes éƒ¨ç½²

**é€‚ç”¨åœºæ™¯**: ä¼ä¸šçº§éƒ¨ç½²ã€é«˜å¯ç”¨æ€§

**deployment.yaml**:
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ai-powershell
spec:
  replicas: 3
  selector:
    matchLabels:
      app: ai-powershell
  template:
    metadata:
      labels:
        app: ai-powershell
    spec:
      containers:
      - name: ai-powershell
        image: ai-powershell:latest
        ports:
        - containerPort: 8080
        env:
        - name: AI_PROVIDER
          value: "azure"
        - name: AZURE_OPENAI_ENDPOINT
          valueFrom:
            secretKeyRef:
              name: ai-secrets
              key: endpoint
        resources:
          requests:
            memory: "512Mi"
            cpu: "500m"
          limits:
            memory: "1Gi"
            cpu: "1000m"
        volumeMounts:
        - name: config
          mountPath: /app/config
      volumes:
      - name: config
        configMap:
          name: ai-powershell-config
```

**service.yaml**:
```yaml
apiVersion: v1
kind: Service
metadata:
  name: ai-powershell
spec:
  selector:
    app: ai-powershell
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8080
  type: LoadBalancer
```

**éƒ¨ç½²å‘½ä»¤**:
```bash
kubectl apply -f deployment.yaml
kubectl apply -f service.yaml
```

**ç‰¹ç‚¹**:
- é«˜å¯ç”¨æ€§
- è‡ªåŠ¨æ‰©å±•
- è´Ÿè½½å‡è¡¡
- å¥åº·æ£€æŸ¥

**æ¶æ„å›¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Kubernetes Cluster              â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      Ingress Controller           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      Service (LoadBalancer)       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚     â–¼            â–¼            â–¼        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Pod â”‚     â”‚ Pod â”‚     â”‚ Pod â”‚      â”‚
â”‚  â”‚  1  â”‚     â”‚  2  â”‚     â”‚  3  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      ConfigMap & Secrets          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚      Persistent Volume            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. äº‘ç«¯éƒ¨ç½²

**AWS éƒ¨ç½²**:
- EC2 å®ä¾‹è¿è¡Œåº”ç”¨
- S3 å­˜å‚¨å†å²è®°å½•
- RDS æ•°æ®åº“å­˜å‚¨
- CloudWatch æ—¥å¿—ç›‘æ§

**Azure éƒ¨ç½²**:
- Azure VM è¿è¡Œåº”ç”¨
- Azure Blob Storage å­˜å‚¨
- Azure SQL Database
- Azure Monitor ç›‘æ§

**GCP éƒ¨ç½²**:
- Compute Engine è¿è¡Œåº”ç”¨
- Cloud Storage å­˜å‚¨
- Cloud SQL æ•°æ®åº“
- Cloud Logging æ—¥å¿—

### 5. æ··åˆéƒ¨ç½²

**åœºæ™¯**: æœ¬åœ° AI æ¨¡å‹ + äº‘ç«¯æœåŠ¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æœ¬åœ°ç¯å¢ƒ                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AI PowerShell æ™ºèƒ½åŠ©æ‰‹            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â–¼            â–¼            â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚æœ¬åœ° â”‚     â”‚äº‘ç«¯ â”‚     â”‚å­˜å‚¨ â”‚       â”‚
â”‚  â”‚AI   â”‚     â”‚AI   â”‚     â”‚æœåŠ¡ â”‚       â”‚
â”‚  â”‚æ¨¡å‹ â”‚     â”‚æœåŠ¡ â”‚     â”‚     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”¬â”€â”€â”˜     â””â”€â”€â”¬â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚           â”‚
                  â–¼           â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      äº‘ç«¯æœåŠ¡            â”‚
         â”‚  - Azure OpenAI         â”‚
         â”‚  - AWS S3               â”‚
         â”‚  - Cloud Logging        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¶æ„å›¾å’Œæ¨¡å—å…³ç³»å›¾

### æ¨¡å—ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    main.py                              â”‚
â”‚              (PowerShellAssistant)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€â”€â”€â”€â–º interfaces/base.py (æ¥å£å®šä¹‰)
        â”‚
        â”œâ”€â”€â”€â”€â”€â–º config/
        â”‚       â”œâ”€â”€ manager.py (ConfigManager)
        â”‚       â””â”€â”€ models.py (é…ç½®æ¨¡å‹)
        â”‚
        â”œâ”€â”€â”€â”€â”€â–º log_engine/
        â”‚       â”œâ”€â”€ engine.py (LogEngine)
        â”‚       â”œâ”€â”€ decorators.py
        â”‚       â””â”€â”€ filters.py
        â”‚
        â”œâ”€â”€â”€â”€â”€â–º storage/
        â”‚       â”œâ”€â”€ interfaces.py (StorageInterface)
        â”‚       â”œâ”€â”€ file_storage.py (FileStorage)
        â”‚       â””â”€â”€ factory.py (StorageFactory)
        â”‚
        â”œâ”€â”€â”€â”€â”€â–º context/
        â”‚       â”œâ”€â”€ manager.py (ContextManager)
        â”‚       â”œâ”€â”€ history.py (HistoryManager)
        â”‚       â””â”€â”€ models.py (æ•°æ®æ¨¡å‹)
        â”‚
        â”œâ”€â”€â”€â”€â”€â–º ai_engine/
        â”‚       â”œâ”€â”€ engine.py (AIEngine)
        â”‚       â”œâ”€â”€ translation.py
        â”‚       â”œâ”€â”€ providers.py
        â”‚       â””â”€â”€ error_detection.py
        â”‚
        â”œâ”€â”€â”€â”€â”€â–º security/
        â”‚       â”œâ”€â”€ engine.py (SecurityEngine)
        â”‚       â”œâ”€â”€ whitelist.py (CommandWhitelist)
        â”‚       â”œâ”€â”€ permissions.py (PermissionChecker)
        â”‚       â””â”€â”€ sandbox.py (SandboxExecutor)
        â”‚
        â””â”€â”€â”€â”€â”€â–º execution/
                â”œâ”€â”€ executor.py (CommandExecutor)
                â”œâ”€â”€ platform_adapter.py
                â””â”€â”€ output_formatter.py
```

### æ•°æ®æµå‘å›¾

```
ç”¨æˆ·è¾“å…¥
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸»æ§åˆ¶å™¨         â”‚
â”‚  (main.py)       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â–º é…ç½®ç®¡ç† â”€â”€â–º åŠ è½½é…ç½®
     â”‚
     â”œâ”€â”€â–º æ—¥å¿—å¼•æ“ â”€â”€â–º è®°å½•æ—¥å¿—
     â”‚
     â”œâ”€â”€â–º ä¸Šä¸‹æ–‡ç®¡ç† â”€â”€â–º è·å–ä¸Šä¸‹æ–‡
     â”‚                  â”‚
     â”‚                  â–¼
     â”‚              å­˜å‚¨å¼•æ“ â”€â”€â–º åŠ è½½å†å²
     â”‚
     â”œâ”€â”€â–º AI å¼•æ“ â”€â”€â–º ç¿»è¯‘å‘½ä»¤
     â”‚              â”‚
     â”‚              â–¼
     â”‚          å­˜å‚¨å¼•æ“ â”€â”€â–º ç¼“å­˜ç»“æœ
     â”‚
     â”œâ”€â”€â–º å®‰å…¨å¼•æ“ â”€â”€â–º éªŒè¯å‘½ä»¤
     â”‚              â”‚
     â”‚              â”œâ”€â”€â–º ç™½åå•æ£€æŸ¥
     â”‚              â”œâ”€â”€â–º æƒé™æ£€æŸ¥
     â”‚              â””â”€â”€â–º æ²™ç®±æ‰§è¡Œ
     â”‚
     â”œâ”€â”€â–º æ‰§è¡Œå¼•æ“ â”€â”€â–º æ‰§è¡Œå‘½ä»¤
     â”‚              â”‚
     â”‚              â””â”€â”€â–º å¹³å°é€‚é…
     â”‚
     â””â”€â”€â–º ä¸Šä¸‹æ–‡ç®¡ç† â”€â”€â–º ä¿å­˜å†å²
                    â”‚
                    â–¼
                å­˜å‚¨å¼•æ“ â”€â”€â–º æŒä¹…åŒ–
```

---

## ç›¸å…³æ–‡æ¡£

- [å¼€å‘è€…æŒ‡å—](developer-guide.md) - å¼€å‘ç¯å¢ƒè®¾ç½®å’Œå¼€å‘è§„èŒƒ
- [ç”¨æˆ·æŒ‡å—](user-guide.md) - ç”¨æˆ·ä½¿ç”¨æŒ‡å—å’ŒåŠŸèƒ½è¯´æ˜
- [éƒ¨ç½²æŒ‡å—](deployment-guide.md) - è¯¦ç»†çš„éƒ¨ç½²å’Œè¿ç»´æŒ‡å—
- [API å‚è€ƒ](api-reference.md) - å®Œæ•´çš„ API æ–‡æ¡£
- [é…ç½®å‚è€ƒ](config-reference.md) - é…ç½®é¡¹è¯¦ç»†è¯´æ˜

## ä¸‹ä¸€æ­¥

- å¦‚æœä½ æ˜¯å¼€å‘è€…ï¼Œå»ºè®®é˜…è¯» [å¼€å‘è€…æŒ‡å—](developer-guide.md)
- å¦‚æœä½ æƒ³éƒ¨ç½²ç³»ç»Ÿï¼Œå»ºè®®é˜…è¯» [éƒ¨ç½²æŒ‡å—](deployment-guide.md)
- å¦‚æœä½ æƒ³äº†è§£å…·ä½“åŠŸèƒ½ï¼Œå»ºè®®é˜…è¯» [ç”¨æˆ·æŒ‡å—](user-guide.md)

---

**éœ€è¦å¸®åŠ©?** æŸ¥çœ‹ [æ•…éšœæ’é™¤æŒ‡å—](troubleshooting.md) æˆ– [æäº¤ Issue](https://github.com/your-repo/ai-powershell/issues)

